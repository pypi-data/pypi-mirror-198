[tox]
envlist=py37{,-server620},py38,py39,py310,py311,pypy3


[testenv]
download = true
commands=
    py.test --instafail {posargs}
deps=
    server620: devpi-server==6.2.0
    beautifulsoup4
    flake8<5
    pytest-cov
    pytest-flake8
    pytest-instafail
    webtest


[pytest]
addopts = -ra --flake8 --cov-report=term --cov-report=html
flake8-ignore = E501
testpaths = src/devpi_constrained
markers =
    nomocking: do not mock anything in fixtures
