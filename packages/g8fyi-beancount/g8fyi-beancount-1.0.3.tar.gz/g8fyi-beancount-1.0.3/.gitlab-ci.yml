stages:
  - package

package:
  stage: package
  image: python:3.10-alpine
  rules:
    - if: $CI_COMMIT_TAG != null && $CI_COMMIT_REF_PROTECTED == "true"
  script:
    - apk add --update make git gcc musl-dev
    - python -m pip install wheel twine
    - python setup.py bdist_wheel --universal
    - python -m twine upload dist/*