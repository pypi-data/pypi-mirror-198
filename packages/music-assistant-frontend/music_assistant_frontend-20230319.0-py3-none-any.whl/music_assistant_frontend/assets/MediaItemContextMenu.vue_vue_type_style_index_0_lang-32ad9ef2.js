import{d as ie,V as w,e as N,f as R,a as j}from"./VCardText-db93722d.js";import{d as Q,c as W,ag as M,h as s,i as v,w as n,b as o,q as f,ah as q,p as _,k as b,M as ne,l as y,m as G,v as h,j as U,f as oe,r as C,z as se,n as u,s as T,x as L,F as B,ai as I,N as k,aj as J,ak as re,al as x}from"./index-b6297644.js";import{_ as Z,a as ue}from"./MediaItemThumb.vue_vue_type_style_index_0_lang-e5f347c5.js";import{a as de,b as ce}from"./ProviderIcons.vue_vue_type_style_index_0_scoped_f7db673c_lang-31b56941.js";import{V as pe,P as me}from"./ListviewItem-326db3c5.js";import{V as fe,a as E}from"./VTooltip-138f7f67.js";import{V as ee}from"./VCard-32859bd2.js";import{V as ye,b as H}from"./VToolbar-b9e353fc.js";import{a as O,V as X}from"./VBtn-a638fdfe.js";import{c as be,V as ge}from"./VSelect-97ee24b5.js";import{V as ve}from"./VDialog-fa825fd4.js";import{V as F}from"./VDivider-6186aa73.js";const Ye=ie("flex-grow-1","div","VSpacer"),he={key:0,style:{position:"absolute",top:"0","background-color":"#82b1ff94",height:"50px"}},_e=["src"],ke={class:"font-weight-bold line-clamp-1",style:{color:"primary","margin-top":"8px","margin-bottom":"8px"}},je=Q({__name:"PanelviewItem",props:{item:null,size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1}},emits:["menu","click","select"],setup(e,{emit:i}){const t=e,p=W(()=>{for(const d of t.item.provider_mappings)if(d.content_type!=null&&d.content_type in[M.DSF,M.FLAC,M.AIFF,M.WAV]&&(d.sample_rate>48e3||d.bit_depth>16))return`${d.sample_rate}kHz ${d.bit_depth} bits`;return""});return(d,m)=>(s(),v(ee,{outlined:"",onClick:m[2]||(m[2]=g=>i("click",e.item)),onContextmenu:m[3]||(m[3]=q(g=>i("menu",e.item),["right","prevent"]))},{default:n(()=>[o(Z,{item:e.item,size:e.size},null,8,["item","size"]),e.showCheckboxes?(s(),f("div",he,[o(pe,{"model-value":e.isSelected,onClick:m[0]||(m[0]=q(()=>{},["stop"])),"onUpdate:modelValue":m[1]||(m[1]=g=>{i("select",e.item,g)})},null,8,["model-value"])])):_("",!0),b(p)?(s(),f("div",{key:1,class:"hiresicon",style:ne(d.$vuetify.theme.current.dark?"background-color: black":"background-color:white")},[o(fe,{bottom:""},{activator:n(({props:g})=>[y("img",G({src:b(de),height:"35"},g,{style:d.$vuetify.theme.current.dark?"object-fit: contain;":"object-fit: contain;filter: invert(100%);"}),null,16,_e)]),default:n(()=>[y("span",null,h(b(p)),1)]),_:1})],4)):_("",!0),o(w,{"two-line":"",style:{"padding-left":"8px","padding-right":"8px"}},{default:n(()=>[y("div",null,[y("p",ke,h(e.item.name),1)]),"artists"in e.item&&e.item.artists?(s(),v(N,{key:0,class:"line-clamp-2",style:{"margin-bottom":"8px"}},{default:n(()=>[U(h(b(ue)(e.item.artists)),1)]),_:1})):"owner"in e.item&&e.item.owner?(s(),v(N,{key:1,class:"line-clamp-2",style:{"margin-bottom":"8px"}},{default:n(()=>[U(h(e.item.owner),1)]),_:1})):_("",!0)]),_:1})]),_:1}))}}),Ae={key:0},Ve={class:"listitem-thumb"},Ce={class:"listitem-actions"},Pe={key:0},Ie={class:"listitem-thumb"},xe=["src"],S=function(e){for(const i of e.provider_mappings)if(i.available)return!0;return!1},we=function(e){for(const i of e.provider_mappings)if(u.providers[i.provider_instance].supported_features.includes(J.SIMILAR_TRACKS))return!0;return!1},Se=function(e,i){const t=[];if(e.length==0||!S(e[0]))return t;let p=I.PLAY,d=I.NEXT;return(e.length>10||[k.ALBUM,k.PLAYLIST].includes(e[0].media_type))&&(p=I.REPLACE,d=I.REPLACE_NEXT),e.length==1&&i&&i.media_type==k.PLAYLIST&&t.push({label:"play_playlist_from",action:()=>{u.playPlaylistFromIndex(i,e[0].position||0)},icon:"mdi-play-circle-outline",labelArgs:[],actionStr:"play"}),e.length==1&&i&&i.media_type==k.ALBUM&&t.push({label:"play_album_from",action:()=>{u.playAlbumFromItem(i,e[0])},icon:"mdi-play-circle-outline",labelArgs:[],actionStr:"play"}),t.push({label:"play_now",action:()=>{u.playMedia(e,p)},icon:"mdi-play-circle-outline",labelArgs:[],actionStr:"play"}),we(e[0])&&t.push({label:"play_radio",action:()=>{u.playMedia(e,p,!0)},icon:"mdi-radio-tower",labelArgs:[],actionStr:"play"}),(e.length===1||e[0].media_type===k.TRACK)&&t.push({label:"play_next",action:()=>{u.playMedia(e,d)},icon:"mdi-skip-next-circle-outline",labelArgs:[],actionStr:"play"}),t.push({label:"add_queue",action:()=>{u.playMedia(e,I.ADD)},icon:"mdi-playlist-plus",labelArgs:[],actionStr:"play"}),t},$e=function(e,i){const t=[];if(e.length==0)return t;if(e.length===1&&e[0]!==i&&S(e[0])&&t.push({label:"show_info",labelArgs:[],action:()=>{x.push({name:e[0].media_type,params:{itemId:e[0].item_id,provider:e[0].provider}})},icon:"mdi-information-outline"}),e.length===1&&S(e[0])&&"artists"in e[0]&&e[0].artists.length===1)for(const p of e[0].artists)t.push({label:"goto_artist",labelArgs:[p.name],action:()=>{x.push({name:"artist",params:{itemId:p.item_id,provider:p.provider}})},icon:"mdi-account-music"});if(e.length===1&&S(e[0])&&"album"in e[0]&&e[0].album&&t.push({label:"goto_album",labelArgs:[e[0].album.name],action:()=>{x.push({name:"album",params:{itemId:e[0].album.item_id,provider:e[0].album.provider}})},icon:"mdi-album"}),e.length===1&&e[0]==i&&t.push({label:"refresh_item",labelArgs:[],action:async()=>{await u.getItemByUri(e[0].uri,!0,!1),x.go(0)},icon:"mdi-refresh"}),!e[0].in_library&&S(e[0])&&t.push({label:"add_library",labelArgs:[],action:()=>{u.addItemsToLibrary(e)},icon:"mdi-heart-outline"}),e[0].in_library&&t.push({label:"remove_library",labelArgs:[],action:()=>{u.removeItemsFromLibrary(e)},icon:"mdi-heart"}),i&&i.media_type===k.PLAYLIST){const p=i;e[0].media_type===k.TRACK&&p.is_editable&&t.push({label:"remove_playlist",labelArgs:[],action:()=>{u.removePlaylistTracks(p.item_id,e.map(d=>d.position))},icon:"mdi-minus-circle-outline"})}return e[0].media_type==="track"&&t.push({label:"add_playlist",labelArgs:[],actionStr:"add_playlist",icon:"mdi-plus-circle-outline"}),e.length==1&&e[0].provider=="database"&&t.push({label:"delete_db",labelArgs:[],action:()=>{u.deleteDbItem(e[0].media_type,e[0].item_id,!0),i&&i.item_id==e[0].item_id&&x.push({name:`${i.media_type}s`})},icon:"mdi-cancel"}),e.length>1&&t.push({label:"clear_selection",labelArgs:[],actionStr:"clear",icon:"mdi-cancel"}),t},qe=Q({__name:"MediaItemContextMenu",props:{items:null,parentItem:{default:void 0},modelValue:{type:Boolean},enablePlayItems:{type:Boolean,default:!0},enableActionMenuItems:{type:Boolean,default:!0},fullscreen:{type:Boolean,default:!0}},emits:["refresh","clear","update:modelValue","update:items"],setup(e,{emit:i}){const t=e,{t:p}=oe(),d=C([]),m=C([]),g=C(""),$=C([]),A=C(!1),z=C("");se(()=>t.modelValue,l=>{l&&te()});const te=async function(){if(A.value=!1,$.value=[],!t.items)return;t.items.length===1?g.value=t.items[0].name:g.value=p("items_selected",[t.items.length]).toString(),T.selectedPlayer&&T.selectedPlayer.available?m.value=Se(t.items,t.parentItem):m.value=[];let l=t.items[0],r=0;if("position"in l&&(r=l.position),l.provider!=="database"){l=await u.getItemByUri(t.items[0].uri),"position"in l&&(l.position=r);const a=t.items;a[0]=l,i("update:items",a)}d.value=$e(t.items,t.parentItem),le()},le=async function(){$.value=[];const l=await u.getPlaylists();for(const r of l.items)r.is_editable&&!(t.parentItem&&t.parentItem.media_type===k.PLAYLIST&&r.item_id===t.parentItem.item_id)&&$.value.push(r)},D=function(l){u.addPlaylistTracks(l.item_id,t.items.map(r=>r.uri)),P()},K=async function(l){const r=await u.createPlaylist(z.value,l);D(r)},Y=async function(l){l.actionStr=="add_playlist"?A.value=!0:l.actionStr=="clear"?(i("clear"),P()):l.action&&l.actionStr=="play"?(l.action(),i("clear"),P()):l.action&&(P(),l.action())},P=function(){t.items.length==1&&i("clear"),i("update:modelValue",!1)},ae=W(()=>{var r,a;const l=[];for(const c in(r=u)==null?void 0:r.players){const V=(a=u)==null?void 0:a.players[c];V.synced_to||l.push({title:V.name,value:V.player_id})}return l.slice().sort((c,V)=>c.title.toUpperCase()>V.title.toUpperCase()?1:-1)});return(l,r)=>(s(),v(ve,{"model-value":e.modelValue,fullscreen:l.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:n(()=>[o(ee,null,{default:n(()=>[o(ye,{dark:""},{default:n(()=>[o(O,{icon:"mdi-play-circle-outline"}),A.value?(s(),v(H,{key:0,style:{"padding-left":"10px"}},{default:n(()=>[y("b",null,h(l.$t("add_playlist")),1),l.$vuetify.display.mobile?_("",!0):(s(),f("span",Ae," | "+h(g.value),1))]),_:1})):(s(),v(H,{key:1,style:{"padding-left":"10px"}},{default:n(()=>[y("b",null,h(g.value),1)]),_:1})),o(O,{icon:"mdi-close",dark:"",text:"",onClick:r[0]||(r[0]=a=>P())})]),_:1}),e.enablePlayItems&&!A.value&&m.value.length>0?(s(),v(R,{key:0},{default:n(()=>{var a;return[o(be,{label:l.$t("play_on"),"model-value":(a=b(T).selectedPlayer)==null?void 0:a.player_id,items:b(ae),"hide-details":"","onUpdate:modelValue":r[1]||(r[1]=c=>{b(T).selectedPlayer=b(u).players[c]})},null,8,["label","model-value","items"]),o(E,null,{default:n(()=>[(s(!0),f(B,null,L(m.value,c=>(s(),f("div",{key:c.label},[o(w,{title:l.$t(c.label,c.labelArgs),density:"default",onClick:V=>Y(c)},{prepend:n(()=>[o(j,{style:{"padding-right":"10px"}},{default:n(()=>[o(X,{icon:c.icon},null,8,["icon"])]),_:2},1024)]),_:2},1032,["title","onClick"]),o(F)]))),128))]),_:1})]}),_:1})):_("",!0),e.enableActionMenuItems&&!A.value&&d.value.length>0?(s(),v(R,{key:1,style:{"padding-top":"0","margin-top":"-10px","padding-bottom":"0"}},{default:n(()=>[o(N,{style:{"margin-left":"10px"}},{default:n(()=>[U(h(l.$t("actions")),1)]),_:1}),o(E,null,{default:n(()=>[(s(!0),f(B,null,L(d.value,a=>(s(),f("div",{key:a.label},[o(w,{title:l.$t(a.label,a.labelArgs),density:"default",onClick:c=>Y(a)},{prepend:n(()=>[o(j,{style:{"padding-right":"10px"}},{default:n(()=>[o(X,{icon:a.icon},null,8,["icon"])]),_:2},1024)]),_:2},1032,["title","onClick"]),o(F)]))),128))]),_:1})]),_:1})):_("",!0),A.value?(s(),v(R,{key:2},{default:n(()=>[o(E,null,{default:n(()=>[(s(!0),f(B,null,L($.value,a=>(s(),f("div",{key:a.item_id},[o(w,{ripple:"",density:"default",onClick:c=>D(a)},{prepend:n(()=>[y("div",Ve,[o(Z,{item:a,size:50,width:"50px",height:"50px"},null,8,["item"])])]),title:n(()=>[y("div",null,h(a.name),1)]),subtitle:n(()=>[y("div",null,h(a.owner),1)]),append:n(()=>[y("div",Ce,[a.provider_mappings?(s(),v(me,{key:0,"provider-mappings":a.provider_mappings,height:20,class:"listitem-actions"},null,8,["provider-mappings"])):_("",!0)])]),_:2},1032,["onClick"]),o(F)]))),128)),(s(!0),f(B,null,L(b(u).providers,a=>(s(),f("div",{key:a.instance_id},[a.supported_features.includes(b(J).PLAYLIST_CREATE)?(s(),f("div",Pe,[o(w,{ripple:""},{prepend:n(()=>[y("div",Ie,[y("img",G(t,{height:40,src:b(ce)(a.type),style:{"margin-left":"5px","margin-top":"5px"}}),null,16,xe)])]),title:n(()=>[o(ge,{label:l.$t("create_playlist",[a.name]),"append-icon":"mdi-playlist-plus",variant:"plain","hide-details":"","onUpdate:modelValue":r[2]||(r[2]=c=>{z.value=c}),"onClick:append":c=>K(a.instance_id),onKeydown:re(c=>K(a.instance_id),["enter"])},null,8,["label","onClick:append","onKeydown"])]),_:2},1024),o(F)])):_("",!0)]))),128))]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1},8,["model-value","fullscreen"]))}});export{Ye as V,qe as _,je as a,$e as b,Se as g,S as i};
