#!/usr/bin/env python3
# This file is placed in the Public Domain.


"medicine care, poison genocide"


import os
import readline
import sys
import termios
import time
import traceback


from gcid.clients import Client
from gcid.command import command, scan
from gcid.console import privileges, wrap
from gcid.default import Default
from gcid.message import Message
from gcid.modules import cmd, irc, log, mdl, rss, tdo
from gcid.objects import Object
from gcid.storage import Storage
from gcid.threads import launch


Storage.workdir = "/var/lib/gcid/"


scan(cmd)
scan(irc)
scan(log)
scan(mdl)
scan(rss)
scan(tdo)


class CLI(Client):

    def announce(self, txt):
        pass

    def raw(self, txt):
        print(txt)
        sys.stdout.flush()


def main():
    privileges("gcid")
    cfg = Message()
    cfg.parse(" ".join(sys.argv[1:]))
    cli = CLI()
    if cfg.otxt:
        evt = command(cli, cfg.otxt)
        evt.wait()

wrap(main)
