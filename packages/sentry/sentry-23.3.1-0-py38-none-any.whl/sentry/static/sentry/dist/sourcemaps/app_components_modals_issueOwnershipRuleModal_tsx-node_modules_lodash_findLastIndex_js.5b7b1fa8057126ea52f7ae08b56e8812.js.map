{"version":3,"file":"chunks/app_components_modals_issueOwnershipRuleModal_tsx-node_modules_lodash_findLastIndex_js.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/views/settings/project/projectOwnership/modal.tsx","webpack:///./app/components/modals/issueOwnershipRuleModal.tsx","webpack:///../node_modules/lodash/findLastIndex.js","webpack:///../node_modules/lodash/uniq.js"],"sourcesContent":["import {Fragment} from 'react';\nimport styled from '@emotion/styled';\nimport uniq from 'lodash/uniq';\n\nimport AsyncComponent from 'sentry/components/asyncComponent';\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport {t, tct} from 'sentry/locale';\nimport ConfigStore from 'sentry/stores/configStore';\nimport {space} from 'sentry/styles/space';\nimport {Frame, Organization, Project, TagWithTopValues} from 'sentry/types';\nimport type {Event} from 'sentry/types/event';\nimport OwnerInput from 'sentry/views/settings/project/projectOwnership/ownerInput';\n\ntype IssueOwnershipResponse = {\n  autoAssignment: boolean;\n  dateCreated: string;\n  fallthrough: boolean;\n  isActive: boolean;\n  lastUpdated: string;\n  raw: string;\n};\n\ntype Props = AsyncComponent['props'] & {\n  issueId: string;\n  onCancel: () => void;\n  organization: Organization;\n  project: Project;\n  eventData?: Event;\n};\n\ntype State = {\n  ownership: null | IssueOwnershipResponse;\n  urlTagData: null | TagWithTopValues;\n} & AsyncComponent['state'];\n\nfunction getFrameSuggestions(eventData?: Event) {\n  // pull frame data out of exception or the stacktrace\n  const entry = eventData?.entries?.find(({type}) =>\n    ['exception', 'stacktrace'].includes(type)\n  );\n\n  let frames: Frame[] = [];\n  if (entry?.type === 'exception') {\n    frames = entry?.data?.values?.[0]?.stacktrace?.frames ?? [];\n  } else if (entry?.type === 'stacktrace') {\n    frames = entry?.data?.frames ?? [];\n  }\n\n  // Only display in-app frames\n  frames = frames.filter(frame => frame && frame.inApp).reverse();\n\n  return uniq(frames.map(frame => frame.filename || frame.absPath || ''));\n}\n\nfunction OwnershipSuggestions({\n  paths,\n  urls,\n  eventData,\n}: {\n  paths: string[];\n  urls: string[];\n  eventData?: Event;\n}) {\n  const email = ConfigStore.get('user')?.email;\n  if (!email) {\n    return null;\n  }\n\n  const pathSuggestion = paths.length ? `path:${paths[0]} ${email}` : null;\n  const urlSuggestion = urls.length ? `url:${urls[0]} ${email}` : null;\n\n  const transactionTag = eventData?.tags?.find(({key}) => key === 'transaction');\n  const transactionSuggestion = transactionTag\n    ? `tags.transaction:${transactionTag.value} ${email}`\n    : null;\n\n  return (\n    <StyledPre>\n      # {t('Hereâ€™s some suggestions based on this issue')}\n      <br />\n      {[pathSuggestion, urlSuggestion, transactionSuggestion]\n        .filter(x => x)\n        .map(suggestion => (\n          <Fragment key={suggestion}>\n            {suggestion}\n            <br />\n          </Fragment>\n        ))}\n    </StyledPre>\n  );\n}\n\nclass ProjectOwnershipModal extends AsyncComponent<Props, State> {\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    const {organization, project, issueId} = this.props;\n    return [\n      ['ownership', `/projects/${organization.slug}/${project.slug}/ownership/`],\n      [\n        'urlTagData',\n        `/issues/${issueId}/tags/url/`,\n        {},\n        {\n          allowError: error =>\n            // Allow for 404s\n            error.status === 404,\n        },\n      ],\n    ];\n  }\n\n  renderBody() {\n    const {ownership, urlTagData} = this.state;\n    const {eventData, organization, project, onCancel} = this.props;\n    if (!ownership) {\n      return null;\n    }\n\n    const urls = urlTagData\n      ? urlTagData.topValues\n          .sort((a, b) => a.count - b.count)\n          .map(i => i.value)\n          .slice(0, 5)\n      : [];\n\n    const hasStreamlineTargetingFeature = organization.features.includes(\n      'streamline-targeting-context'\n    );\n    const paths = getFrameSuggestions(eventData);\n\n    return (\n      <Fragment>\n        {hasStreamlineTargetingFeature ? (\n          <Fragment>\n            <Description>\n              {tct(\n                'Assign issues based on custom rules. To learn more, [docs:read the docs].',\n                {\n                  docs: (\n                    <ExternalLink href=\"https://docs.sentry.io/product/issues/issue-owners/\" />\n                  ),\n                }\n              )}\n            </Description>\n            <OwnershipSuggestions paths={paths} urls={urls} eventData={eventData} />\n          </Fragment>\n        ) : (\n          <p>{t('Match against Issue Data: (globbing syntax *, ? supported)')}</p>\n        )}\n        <OwnerInput\n          organization={organization}\n          project={project}\n          initialText={ownership?.raw || ''}\n          urls={urls}\n          paths={paths}\n          dateUpdated={ownership.lastUpdated}\n          onCancel={onCancel}\n        />\n      </Fragment>\n    );\n  }\n}\n\nconst Description = styled('p')`\n  margin-bottom: ${space(1)};\n`;\n\nconst StyledPre = styled('pre')`\n  word-break: break-word;\n  padding: ${space(2)};\n  line-height: 1.6;\n  color: ${p => p.theme.subText};\n`;\n\nexport default ProjectOwnershipModal;\n","import {Fragment} from 'react';\nimport {css} from '@emotion/react';\n\nimport {ModalRenderProps} from 'sentry/actionCreators/modal';\nimport {t} from 'sentry/locale';\nimport type {Event, Organization, Project} from 'sentry/types';\nimport theme from 'sentry/utils/theme';\nimport ProjectOwnershipModal from 'sentry/views/settings/project/projectOwnership/modal';\n\ninterface CreateOwnershipRuleProps extends ModalRenderProps {\n  issueId: string;\n  organization: Organization;\n  project: Project;\n  eventData?: Event;\n}\n\nconst IssueOwnershipRuleModal = ({\n  Body,\n  Header,\n  Footer: _Footer,\n  organization,\n  project,\n  issueId,\n  eventData,\n  closeModal,\n}: CreateOwnershipRuleProps) => {\n  return (\n    <Fragment>\n      <Header closeButton>\n        <h4>{t('Edit Ownership Rules')}</h4>\n      </Header>\n      <Body>\n        <ProjectOwnershipModal\n          organization={organization}\n          project={project}\n          issueId={issueId}\n          eventData={eventData}\n          onCancel={closeModal}\n        />\n      </Body>\n    </Fragment>\n  );\n};\n\nexport const modalCss = css`\n  @media (min-width: ${theme.breakpoints.small}) {\n    width: 80%;\n  }\n`;\n\nexport default IssueOwnershipRuleModal;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIteratee = require('./_baseIteratee'),\n    toInteger = require('./toInteger');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * This method is like `_.findIndex` except that it iterates over elements\n * of `collection` from right to left.\n *\n * @static\n * @memberOf _\n * @since 2.0.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=array.length-1] The index to search from.\n * @returns {number} Returns the index of the found element, else `-1`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'active': true },\n *   { 'user': 'fred',    'active': false },\n *   { 'user': 'pebbles', 'active': false }\n * ];\n *\n * _.findLastIndex(users, function(o) { return o.user == 'pebbles'; });\n * // => 2\n *\n * // The `_.matches` iteratee shorthand.\n * _.findLastIndex(users, { 'user': 'barney', 'active': true });\n * // => 0\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.findLastIndex(users, ['active', false]);\n * // => 2\n *\n * // The `_.property` iteratee shorthand.\n * _.findLastIndex(users, 'active');\n * // => 0\n */\nfunction findLastIndex(array, predicate, fromIndex) {\n  var length = array == null ? 0 : array.length;\n  if (!length) {\n    return -1;\n  }\n  var index = length - 1;\n  if (fromIndex !== undefined) {\n    index = toInteger(fromIndex);\n    index = fromIndex < 0\n      ? nativeMax(length + index, 0)\n      : nativeMin(index, length - 1);\n  }\n  return baseFindIndex(array, baseIteratee(predicate, 3), index, true);\n}\n\nmodule.exports = findLastIndex;\n","var baseUniq = require('./_baseUniq');\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? baseUniq(array) : [];\n}\n\nmodule.exports = uniq;\n"],"names":["OwnershipSuggestions","_ref2","paths","urls","eventData","email","ConfigStore","pathSuggestion","length","urlSuggestion","transactionTag","tags","find","_ref3","key","transactionSuggestion","value","_jsxs","StyledPre","children","t","_jsx","filter","x","map","suggestion","Fragment","displayName","ProjectOwnershipModal","AsyncComponent","getEndpoints","organization","project","issueId","this","props","slug","allowError","error","status","renderBody","ownership","urlTagData","state","onCancel","topValues","sort","a","b","count","i","slice","hasStreamlineTargetingFeature","features","includes","entry","entries","_ref","type","frames","data","values","stacktrace","frame","inApp","reverse","uniq","filename","absPath","getFrameSuggestions","Description","tct","docs","ExternalLink","href","OwnerInput","initialText","raw","dateUpdated","lastUpdated","_styled","target","space","p","theme","subText","IssueOwnershipRuleModal","Body","Header","Footer","_Footer","closeModal","closeButton","modalCss","css","baseFindIndex","baseIteratee","toInteger","nativeMax","Math","max","nativeMin","min","module","exports","array","predicate","fromIndex","index","undefined","baseUniq"],"sourceRoot":""}