"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_components_dataZoomInside_tsx-app_components_charts_components_toolBox_-9c2fbe"],{"./app/components/charts/components/dataZoomInside.tsx":(e,t,i)=>{i.d(t,{Z:()=>r}),i("../node_modules/echarts/lib/component/dataZoomInside.js");const n={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function r(e){return e&&Array.isArray(e)?e:[{...n,...e}]}},"./app/components/charts/components/toolBox.tsx":(e,t,i)=>{function n(){let{dataZoom:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo"},...e}}:{},...t}}function r(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:n(t),...e}}i.d(t,{Z:()=>r})},"./app/components/profiling/flex.tsx":(e,t,i)=>{i.d(t,{k:()=>a});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");const r=e=>"string"==typeof e?e:"number"==typeof e?e+"px":void 0,o=(0,n.Z)("div",{target:"e12bnk0l1"})("display:flex;height:",(e=>r(e.h)),";width:",(e=>r(e.w)),";min-height:",(e=>r(e.minH)),";max-height:",(e=>r(e.maxH)),";padding:",(e=>r(e.p)),";padding-left:",(e=>r(e.pl||e.px)),";padding-right:",(e=>r(e.pr||e.px)),";padding-top:",(e=>r(e.pt||e.py)),";padding-bottom:",(e=>r(e.pb||e.py)),";margin:",(e=>r(e.m)),";margin-left:",(e=>r(e.ml||e.mx)),";margin-right:",(e=>r(e.mr||e.mx)),";margin-top:",(e=>r(e.mt||e.my)),";margin-bottom:",(e=>r(e.mb||e.my)),";flex-direction:",(e=>e.column?"column":"row"),";justify-content:",(e=>e.justify),";align-items:",(e=>e.align),";gap:",(e=>r(e.gap)),";flex-wrap:",(e=>e.wrap),";"),s=(0,n.Z)("div",{target:"e12bnk0l0"})("flex-grow:",(e=>e.grow),";flex-shrink:",(e=>e.shrink),";flex-basis:",(e=>e.basis),";overflow:hidden;"),a=Object.assign(o,{...o,Container:o,Item:s})},"./app/components/profiling/functionsMiniGrid.tsx":(e,t,i)=>{i.d(t,{EA:()=>g,nL:()=>m,q8:()=>f});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=i("../node_modules/react/index.js"),o=i("./app/components/links/link.tsx"),s=i("./app/components/loadingIndicator.tsx"),a=i("./app/components/performanceDuration.tsx"),l=i("./app/components/profiling/flex.tsx"),c=i("./app/locale.tsx"),p=i("./app/styles/space.tsx"),d=i("./app/utils/profiling/routes.tsx"),u=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){const{organization:t,project:i,functions:n,onLinkClick:s}=e;return(0,u.BX)(h,{children:[(0,u.tZ)(x,{children:(0,c.t)("Slowest app functions")}),(0,u.tZ)(x,{align:"right",children:(0,c.t)("P95")}),(0,u.tZ)(x,{align:"right",children:(0,c.t)("Count")}),n&&n.map(((e,n)=>{const l=e.worst.replaceAll("-","");return(0,u.BX)(r.Fragment,{children:[(0,u.tZ)(y,{title:e.name,children:(0,u.tZ)(w,{children:(0,u.tZ)(o.Z,{to:(c=l,p=e.name,m=e.package,(0,d.u$)({orgSlug:t.slug,projectSlug:i.slug,profileId:c,frameName:p,framePackage:m})),onClick:s,children:e.name})})}),(0,u.tZ)(y,{align:"right",children:(0,u.tZ)(a.Z,{nanoseconds:e.p95,abbreviation:!0})}),(0,u.tZ)(y,{align:"right",children:(0,u.tZ)(v,{children:e.count})})]},n);var c,p,m}))]})}function f(){return(0,u.tZ)(l.k,{align:"stretch",justify:"center",column:!0,h:"100%",children:(0,u.tZ)(l.k,{align:"center",justify:"center",children:(0,u.tZ)(s.Z,{mini:!0})})})}function g(){return(0,u.tZ)(l.k,{align:"stretch",justify:"center",column:!0,h:"100%",children:(0,u.tZ)(l.k,{align:"center",justify:"center",children:(0,c.t)("No functions data")})})}m.displayName="FunctionsMiniGrid",f.displayName="FunctionsMiniGridLoading",g.displayName="FunctionsMiniGridEmptyState";const h=(0,n.Z)("div",{target:"e1f47tm54"})({name:"z3l44r",styles:"display:grid;grid-template-columns:60% 20% 20%"}),x=(0,n.Z)("span",{target:"e1f47tm53"})("text-transform:uppercase;font-size:",(e=>e.theme.fontSizeExtraSmall),";font-weight:600;color:",(e=>e.theme.subText),";text-align:",(e=>e.align),";"),y=(0,n.Z)("div",{target:"e1f47tm52"})("font-size:",(e=>e.theme.fontSizeSmall),";text-align:",(e=>e.align),";padding:",(0,p.D)(.5)," 0px;"),v=(0,n.Z)("div",{target:"e1f47tm51"})({name:"2qga7i",styles:"text-align:right"}),w=(0,n.Z)("div",{target:"e1f47tm50"})({name:"btttr4",styles:"min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis"})},"./app/components/profiling/profileEventsTable.tsx":(e,t,i)=>{i.d(t,{Q:()=>B});var n=i("../node_modules/react/index.js"),r=i("./app/components/count.tsx"),o=i("./app/components/dateTime.tsx"),s=i("./app/components/gridEditable/index.tsx"),a=i("./app/components/idBadge/projectBadge.tsx"),l=i("./app/components/links/link.tsx"),c=i("./app/components/performanceDuration.tsx"),p=i("./app/components/userMisery.tsx"),d=i("./app/components/version.tsx"),u=i("./app/locale.tsx"),m=i("./app/utils.tsx"),f=i("./app/utils/discover/fieldRenderers.tsx"),g=i("./app/utils/discover/styles.tsx"),h=i("./app/utils/events.tsx"),x=i("./app/utils/profiling/routes.tsx"),y=i("./app/utils/profiling/tableRenderer.tsx"),v=i("./app/utils/useLocation.tsx"),w=i("./app/utils/useOrganization.tsx"),Z=i("./app/utils/useProjects.tsx"),b=i("./app/views/discover/table/quickContext/quickContextWrapper.tsx"),k=i("./app/views/discover/table/quickContext/utils.tsx"),j=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),_=i("./app/components/hovercard.tsx"),S=i("./app/components/profiling/flex.tsx"),z=i("./app/components/profiling/functionsMiniGrid.tsx"),P=i("./app/components/profiling/textTruncateOverflow.tsx"),I=i("./app/styles/space.tsx"),E=i("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),q=i("./app/utils/profiling/hooks/useProfilingTransactionQuickSummary.tsx"),T=i("./app/components/button.tsx"),C=i("./app/components/loadingIndicator.tsx"),F=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function A(e){const{project:t,transaction:i,organization:n}=e,{query:r}=(0,v.T)(),o=(0,x.R0)({query:r,orgSlug:n.slug,projectSlug:t.slug,transaction:i}),s=(0,F.tZ)(l.Z,{to:o,onClick:()=>(0,E.Z)("profiling_views.go_to_transaction",{organization:n,source:"transaction_hovercard.trigger"}),children:i});return(0,F.tZ)(O,{delay:250,header:(0,F.BX)(S.k,{justify:"space-between",align:"center",children:[(0,F.tZ)(P.W,{children:i}),(0,F.tZ)(T.zx,{to:o,size:"xs",children:(0,u.t)("View Profiles")})]}),body:(0,F.tZ)(L,{transaction:i,project:t,organization:n}),showUnderline:!0,children:s})}function L(e){let{transaction:t,project:i,organization:r}=e;const{slowestProfile:o,slowestProfileQuery:s,slowestProfileDurationMultiplier:a,latestProfileQuery:p,latestProfile:d,functionsQuery:m,functions:f}=(0,q.d)({transaction:t,project:i,referrer:"api.profiling.profiling-transaction-hovercard"}),g=(e,t)=>(0,x.TH)({orgSlug:r.slug,projectSlug:i.slug,profileId:e,query:t});return(0,n.useEffect)((()=>{(0,E.Z)("profiling_ui_events.transaction_hovercard_view",{organization:r})}),[r]),(0,F.BX)(S.k,{gap:(0,I.D)(3),column:!0,children:[(0,F.BX)(S.k,{justify:"space-between",children:[(0,F.tZ)(R,{title:(0,u.t)("Latest profile"),isLoading:p.isLoading,children:d?(0,F.tZ)(l.Z,{to:g(String(d["profile.id"])),onClick:()=>(0,E.Z)("profiling_views.go_to_flamegraph",{organization:r,source:"transaction_hovercard.latest_profile"}),children:(0,h.XQ)(String(d["profile.id"]))}):"-"}),(0,F.tZ)(R,{title:(0,u.t)("Slowest profile"),isLoading:s.isLoading,children:o?(0,F.BX)(S.k,{gap:(0,I.D)(1),children:[(0,F.tZ)(c.Z,{milliseconds:a*o["transaction.duration"],abbreviation:!0}),(0,F.BX)(l.Z,{to:g(String(o["profile.id"])),onClick:()=>(0,E.Z)("profiling_views.go_to_flamegraph",{organization:r,source:"transaction_hovercard.slowest_profile"}),children:["(",(0,h.XQ)(String(o["profile.id"])),")"]})]}):"-"})]}),(0,F.tZ)(S.k,{column:!0,h:125,children:(0,F.tZ)(M,{isLoading:m.isLoading,functions:f??[],organization:r,project:i,onLinkClick:()=>(0,E.Z)("profiling_views.go_to_flamegraph",{organization:r,source:"transaction_hovercard.suspect_function"})})})]})}function M(e){return e.isLoading?(0,F.tZ)(z.q8,{}):e.functions&&0!==e.functions?.length?(0,F.tZ)(z.nL,{...e}):(0,F.tZ)(z.EA,{})}function R(e){const{title:t,children:i,isLoading:r}=e;return(0,F.BX)(S.k,{column:!0,gap:(0,I.D)(1),children:[t&&(0,F.tZ)(D,{children:t}),(0,F.tZ)(n.Fragment,{children:r?(0,F.tZ)(S.k,{align:"center",justify:"center",h:"1em",children:(0,F.tZ)(C.Z,{mini:!0})}):i})]})}A.displayName="ProfilingTransactionHovercard",L.displayName="ProfilingTransactionHovercardBody",M.displayName="ProfilingTransactionHovercardFunctions",R.displayName="ContextDetail";const D=(0,j.Z)("span",{target:"e1gnxyp31"})("text-transform:uppercase;font-size:",(e=>e.theme.fontSizeExtraSmall),";font-weight:600;color:",(e=>e.theme.subText),";"),O=(0,j.Z)(_.uI,{target:"e1gnxyp30"})({name:"3s4yqf",styles:"width:400px"});function B(e){const t=(0,v.T)(),i=(0,w.Z)(),{projects:r}=(0,Z.Z)(),o=(0,n.useCallback)((i=>()=>{let n="desc";return i===e.sort.key&&e.sort.order===n&&(n="asc"),{...t,query:{...t.query,sort:"asc"===n?i:`-${i}`}}}),[t,e.sort]);return(0,F.tZ)(s.ZP,{isLoading:e.isLoading,error:e.error,data:e.data?.data??[],columnOrder:e.columns.map((e=>function(e){return N[e]?N[e]:{key:e,name:e,width:s.z7}}(e))),columnSortBy:[e.sort],grid:{renderHeadCell:(0,y.w)({currentSort:e.sort,generateSortLink:o,rightAlignedColumns:(c=e.columns,new Set(c.filter((e=>G.has(e))))),sortableColumns:e.sortableColumns}),renderBodyCell:(a=e.data?.meta??{fields:{},units:{}},l={location:t,organization:i,projects:r},function(e,t,i,n){return(0,F.tZ)(H,{meta:a,baggage:l,column:e,dataRow:t,rowIndex:i,columnIndex:n})})},location:t});var a,l,c}function H(e){const t=e.column.key,i=e.dataRow[t],n=e.meta.fields[t],s=e.meta.units[t];if("id"===t||"profile.id"===t){const t=W(e.baggage,e.dataRow);if(!(0,m.ri)(t))return(0,F.tZ)(g.W2,{children:(0,h.XQ)(i)});const n=(0,x.O$)({orgSlug:e.baggage.organization.slug,projectSlug:t.slug,profileId:i});return(0,F.tZ)(g.W2,{children:(0,F.tZ)(l.Z,{to:n,children:(0,h.XQ)(i)})})}if("project.id"===t||"project"===t||"project.name"===t){const t=W(e.baggage,e.dataRow);return(0,m.ri)(t)?(0,F.tZ)(g.W2,{children:(0,F.tZ)(a.Z,{project:t,avatarSize:16})}):(0,F.tZ)(g.W2,{children:(0,u.t)("n/a")})}if("transaction"===t){const t=W(e.baggage,e.dataRow);if((0,m.ri)(t))return(0,F.tZ)(g.W2,{children:(0,F.tZ)(A,{transaction:i,project:t,organization:e.baggage.organization})})}if("release"===t&&i)return(0,F.tZ)(b.V,{dataRow:e.dataRow,contextType:k.z.RELEASE,organization:e.baggage.organization,children:(0,F.tZ)(d.Z,{version:i,truncate:!0})});if("user_misery()"===t)return(0,F.tZ)(p.Z,{bars:10,barHeight:20,miserableUsers:void 0,miseryLimit:void 0,totalUsers:void 0,userMisery:i||0});switch(n){case"integer":case"number":return(0,F.tZ)(g.Hw,{children:(0,F.tZ)(r.Z,{value:i})});case"duration":const e=s?f.a_[s]??1:1;return(0,F.tZ)(g.Hw,{children:(0,F.tZ)(c.Z,{milliseconds:i*e,abbreviation:!0})});case"date":return(0,F.tZ)(g.W2,{children:(0,F.tZ)(o.Z,{date:i,year:!0,seconds:!0,timeZone:!0})});default:return(0,F.tZ)(g.W2,{children:i})}}function W(e,t){let i;if((0,m.ri)(t["project.id"])){const n=t["project.id"].toString();i=e.projects.find((e=>e.id===n))}else if((0,m.ri)(t.project)){const n=t.project;i=e.projects.find((e=>e.slug===n))}else if((0,m.ri)(t["project.name"])){const n=t["project.name"];i=e.projects.find((e=>e.slug===n))}return i??null}B.displayName="ProfileEventsTable";const G=new Set(["transaction.duration","profile.duration","p75()","p95()","p99()","count()"]),N={id:{key:"id",name:(0,u.t)("Profile ID"),width:s.z7},"profile.id":{key:"profile.id",name:(0,u.t)("Profile ID"),width:s.z7},trace:{key:"trace",name:(0,u.t)("Trace ID"),width:s.z7},"trace.transaction":{key:"trace.transaction",name:(0,u.t)("Transaction ID"),width:s.z7},transaction:{key:"transaction",name:(0,u.t)("Transaction"),width:s.z7},"transaction.duration":{key:"transaction.duration",name:(0,u.t)("Duration"),width:s.z7},"profile.duration":{key:"profile.duration",name:(0,u.t)("Duration"),width:s.z7},project:{key:"project",name:(0,u.t)("Project"),width:s.z7},"project.id":{key:"project.id",name:(0,u.t)("Project"),width:s.z7},"project.name":{key:"project.name",name:(0,u.t)("Project"),width:s.z7},environment:{key:"environment",name:(0,u.t)("Environment"),width:s.z7},timestamp:{key:"timestamp",name:(0,u.t)("Timestamp"),width:s.z7},release:{key:"release",name:(0,u.t)("Release"),width:s.z7},"platform.name":{key:"platform.name",name:(0,u.t)("Platform"),width:s.z7},"device.arch":{key:"device.arch",name:(0,u.t)("Device Architecture"),width:s.z7},"device.classification":{key:"device.classification",name:(0,u.t)("Device Classification"),width:s.z7},"device.locale":{key:"device.locale",name:(0,u.t)("Device Locale"),width:s.z7},"device.manufacturer":{key:"device.manufacturer",name:(0,u.t)("Device Manufacturer"),width:s.z7},"device.model":{key:"device.model",name:(0,u.t)("Device Model"),width:s.z7},"os.build":{key:"os.build",name:(0,u.t)("OS Build"),width:s.z7},"os.name":{key:"os.name",name:(0,u.t)("OS Name"),width:s.z7},"os.version":{key:"os.version",name:(0,u.t)("OS Version"),width:s.z7},"last_seen()":{key:"last_seen()",name:(0,u.t)("Last Seen"),width:s.z7},"p75()":{key:"p75()",name:(0,u.t)("P75"),width:s.z7},"p95()":{key:"p95()",name:(0,u.t)("P95()"),width:s.z7},"p99()":{key:"p99()",name:(0,u.t)("P99()"),width:s.z7},"count()":{key:"count()",name:(0,u.t)("Count()"),width:s.z7},"user_misery()":{key:"user_misery()",name:(0,u.t)("User Misery"),width:110}}},"./app/components/profiling/textTruncateOverflow.tsx":(e,t,i)=>{i.d(t,{W:()=>a});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=i("./app/styles/space.tsx"),o=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function s(e){const{children:t,as:i="div",...n}=e;return(0,o.tZ)(i,{...n,title:t,children:t})}s.displayName="TextOverflow";const a=(0,n.Z)(s,{target:"eihcg730"})("min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-right:",(0,r.D)(1),";")},"./app/utils/profiling/hooks/useProfileEvents.tsx":(e,t,i)=>{i.d(t,{GP:()=>p,Z:()=>d,kq:()=>u}),i("../node_modules/core-js/modules/es.array.includes.js");var n=i("../node_modules/@tanstack/react-query/build/lib/useQuery.mjs"),r=i("./app/components/organizations/pageFilters/parse.tsx"),o=i("./app/locale.tsx"),s=i("./app/utils.tsx"),a=i("./app/utils/useApi.tsx"),l=i("./app/utils/useOrganization.tsx"),c=i("./app/utils/usePageFilters.tsx");function p(e){let{fields:t,limit:i,referrer:o,query:s,sort:p,cursor:d,enabled:u=!0,refetchOnMount:m=!0,datetime:f,projects:g}=e;const h=(0,a.Z)(),x=(0,l.Z)(),{selection:y}=(0,c.Z)();let v="profiles";x.features.includes("profiling-using-transactions")&&(v="discover",s=`has:profile.id ${s??""}`);const w=`/organizations/${x.slug}/events/`,Z={query:{dataset:v,referrer:o,project:g||y.projects,environment:y.environments,...(0,r.fK)(f??y.datetime),field:t,per_page:i,query:s,sort:"asc"===p.order?p.key:`-${p.key}`,cursor:d}},b=[w,Z];return(0,n.a)({queryKey:b,queryFn:()=>h.requestPromise(w,{method:"GET",includeAllArgs:!0,query:Z.query}),refetchOnWindowFocus:!1,refetchOnMount:m,retry:!1,enabled:u})}function d(e){if(!(0,s.ri)(e))return null;const t=e.responseJSON?.detail;if("string"==typeof t)return t;const i=t?.message;return"string"==typeof i?i:(0,o.t)("An unknown error occurred.")}function u(e,t,i){const n="-"===(e=e||"")[0]?"desc":"asc",r="asc"===n?e:e.substring(1);return t.includes(r)?{key:r,order:n}:i}},"./app/utils/profiling/hooks/useProfileFilters.tsx":(e,t,i)=>{i.d(t,{J:()=>a});var n=i("../node_modules/react/index.js"),r=i("./app/components/organizations/pageFilters/parse.tsx"),o=i("./app/utils/useApi.tsx"),s=i("./app/utils/useOrganization.tsx");function a(e){let{query:t,selection:i,disabled:a}=e;const c=(0,o.Z)(),p=(0,s.Z)(),[d,u]=(0,n.useState)({});return(0,n.useEffect)((()=>{if(!a&&i)return function(e,t,i,n){return e.requestPromise(`/organizations/${t.slug}/profiling/filters/`,{method:"GET",query:{query:i,project:n.projects,environment:n.environments,...(0,r.fK)(n.datetime)}})}(c,p,t,i).then((e=>{const t=e.reduce(((e,t)=>(l[t.key]&&(t.key=l[t.key],e[t.key]={...t,predefined:!0}),e)),{});u(t)})),()=>c.clear()}),[c,p,t,i,a]),d}const l={version:"release",device_locale:"device.locale",platform:"platform.name",transaction_name:"transaction",device_os_build_number:"os.build",device_os_name:"os.name",device_os_version:"os.version",device_model:"device.model",device_manufacturer:"device.manufacturer",device_classification:"device.classification"}},"./app/utils/profiling/hooks/useProfilingTransactionQuickSummary.tsx":(e,t,i)=>{i.d(t,{d:()=>l});var n=i("./app/utils/discover/fieldRenderers.tsx"),r=i("./app/utils/profiling/hooks/useFunctions.tsx"),o=i("./app/utils/profiling/hooks/useProfileEvents.tsx"),s=i("./app/utils/usePageFilters.tsx"),a=i("./app/views/profiling/profileSummary/content.tsx");function l(e){const{transaction:t,project:i,referrer:l,skipFunctions:c=!1,skipLatestProfile:p=!1,skipSlowestProfile:d=!1}=e,{selection:u}=(0,s.Z)(),m={query:`transaction:"${t}"`,fields:(0,a.H)(i.platform),enabled:Boolean(t),limit:1,referrer:l,refetchOnMount:!1,projects:[i.id]},f=(0,o.GP)({...m,sort:{key:"transaction.duration",order:"desc"},enabled:!d}),g=(0,o.GP)({...m,sort:{key:"timestamp",order:"desc"},enabled:!p}),h=(0,r.d)({project:i,query:"",selection:u,transaction:t,sort:"-p95",functionType:"application",enabled:!c}),x=f?.data?.[0].data[0]??null,y=f.data?.[0].meta.units["transaction.duration"],v=y?n.a_[y]??1:1,w=g?.data?.[0].data[0]??null,Z=h?.data?.[0]?.functions;return{slowestProfileQuery:f,slowestProfile:x,slowestProfileDurationMultiplier:v,latestProfileQuery:g,latestProfile:w,functionsQuery:h,functions:Z,isLoading:f.isLoading||g.isLoading||h.isLoading}}},"./app/utils/useEffectAfterFirstRender.ts":(e,t,i)=>{i.d(t,{K:()=>r});var n=i("../node_modules/react/index.js");const r=(e,t)=>{const i=(0,n.useRef)(!0);(0,n.useEffect)((()=>{i.current?i.current=!1:e()}),t)}},"./app/views/profiling/landing/profileCharts.tsx":(e,t,i)=>{i.d(t,{A:()=>j});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(i("../node_modules/core-js/modules/es.array.includes.js"),i("../node_modules/core-js/modules/es.error.cause.js"),i("../node_modules/react/index.js")),o=i("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),s=i("./app/components/charts/areaChart.tsx"),a=i("./app/components/charts/chartZoom.tsx"),l=i("./app/components/charts/styles.tsx"),c=i("./app/components/panels/index.tsx"),p=i("./app/locale.tsx"),d=i("./app/styles/space.tsx"),u=i("./app/utils/discover/charts.tsx"),m=i("./app/utils/discover/fields.tsx"),f=(i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/@tanstack/react-query/build/lib/useQuery.mjs")),g=i("./app/components/organizations/pageFilters/parse.tsx"),h=i("./app/utils/profiling/units/units.ts"),x=i("./app/utils/useApi.tsx"),y=i("./app/utils/useOrganization.tsx"),v=i("./app/utils/usePageFilters.tsx");function w(e,t){const i="duration"===(t.meta.fields[e]??t.meta.fields[(0,m.LY)(e)])?(0,h.fr)(t.meta.units[e]??t.meta.units[(0,m.LY)(e)]??"nanoseconds","milliseconds"):e=>e,n={axis:e,values:[]},r={dataset:"profiles",end:t.end,start:t.start},o=[];for(let e=0;e<t.data.length;e++){const[r,s]=t.data[e];n.values.push(i(s[0].count)),o.push(r)}return{series:n,meta:r,timestamps:o}}var Z=i("./app/utils/useRouter.tsx"),b=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const k=["count()","p99()","p95()","p75()"];function j(e){let{query:t,selection:i,hideCount:n,compact:l=!1}=e;const c=(0,Z.Z)(),d=(0,o.u)(),h=(0,r.useMemo)((()=>n?k.filter((e=>"count()"!==e)):k),[n]),j=function(e){let{yAxes:t,interval:i,query:n,referrer:r}=e;const o=(0,x.Z)(),s=(0,y.Z)(),{selection:a}=(0,v.Z)();let l="profiles";s.features.includes("profiling-using-transactions")&&(l="discover",n=`has:profile.id ${n??""}`);const c=`/organizations/${s.slug}/events-stats/`,p={query:{dataset:l,referrer:r,project:a.projects,environment:a.environments,...(0,g.fK)(a.datetime),yAxis:t,interval:i,query:n}},d=[c,p];return(0,f.a)({queryKey:d,queryFn:()=>o.requestPromise(c,{method:"GET",includeAllArgs:!0,query:p.query}).then((e=>function(e,t){if(0===e.length)return[{data:[],meta:{dataset:"profiles",end:0,start:0},timestamps:[]},t[1],t[2]];if(1===e.length){const{series:i,meta:n,timestamps:r}=w(e[0],t[0]);return[{data:[i],meta:n,timestamps:r},t[1],t[2]]}const i=[];let n={dataset:"profiles",end:-1,start:-1},r=[],o=!0;for(const s of e){const e=w(s,t[0][s]);if(o)n=e.meta,r=e.timestamps;else{if(n.start!==e.meta.start||n.end!==e.meta.end)throw new Error("Mismatching start/end times");if(r.length!==e.timestamps.length||r.some(((t,i)=>t!==e.timestamps[i])))throw new Error("Mismatching timestamps")}i.push(e.series),o=!1}return[{data:i,meta:n,timestamps:r},t[1],t[2]]}(t,e))),refetchOnWindowFocus:!1,retry:!1})}({query:t,referrer:"api.profiling.landing-chart",yAxes:h}),P=(0,r.useMemo)((()=>{if("success"!==j.status)return[];const e=j.data[0].timestamps.map((e=>1e3*e)),t=j.data[0].data.filter((e=>h.includes(e.axis))).map((t=>{if(e.length!==t.values.length)throw new Error("Invalid stats response");return"count()"===t.axis?{data:t.values.map(((t,i)=>({name:e[i],value:t??0}))),seriesName:t.axis,xAxisIndex:0,yAxisIndex:0}:{data:t.values.map(((t,i)=>({name:e[i],value:t??0}))),seriesName:t.axis,xAxisIndex:1,yAxisIndex:1}}));return t.sort(((e,t)=>h.indexOf(e.seriesName)-h.indexOf(t.seriesName))),t}),[j,h]);return(0,b.tZ)(a.Z,{router:c,...i?.datetime,children:e=>(0,b.BX)(_,{children:[(0,b.BX)(S,{children:[!n&&(0,b.tZ)(z,{compact:!0,children:(0,p.t)("Profiles by Count")}),(0,b.tZ)(z,{compact:!0,children:(0,p.t)("Profiles by Percentiles")})]}),(0,b.tZ)(s.T,{height:l?150:300,series:P,grid:[{top:"32px",left:"24px",right:"52%",bottom:"16px"},{top:"32px",left:n?"24px":"52%",right:"24px",bottom:"16px"}],legend:{right:16,top:12,data:h.slice()},axisPointer:{link:[{xAxisIndex:[0,1]}]},xAxes:[{show:!n,gridIndex:0,type:"time"},{gridIndex:1,type:"time"}],yAxes:[{gridIndex:0,scale:!0,axisLabel:{color:d.chartLabel,formatter:e=>(0,u.gu)(e,"integer")}},{gridIndex:1,scale:!0,axisLabel:{color:d.chartLabel,formatter:e=>(0,u.gu)(e,"duration")}}],tooltip:{valueFormatter:(e,t)=>(0,u.CX)(e,(0,m.Px)(t))},isGroupedByDate:!0,showTimeInTooltip:!0,...e})]})})}j.displayName="ProfileCharts";const _=(0,n.Z)(c.s_,{target:"e1xfi5vp2"})("padding-top:",(0,d.D)(2),";"),S=(0,n.Z)("div",{target:"e1xfi5vp1"})({name:"ai16bo",styles:"width:100%;display:flex;flex-direction:row"}),z=(0,n.Z)(l.Gh,{target:"e1xfi5vp0"})("flex-grow:1;margin-left:",(0,d.D)(2),";font-size:",(e=>e.compact?e.theme.fontSizeSmall:void 0),";")},"./app/views/profiling/profileSummary/content.tsx":(e,t,i)=>{i.d(t,{J:()=>ee,H:()=>te});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/core-js/modules/es.array.includes.js"),i("../node_modules/react/index.js")),o=i("../node_modules/react-router/es/index.js"),s=i("./app/components/compactSelect/index.tsx"),a=i("./app/components/layouts/thirds.tsx"),l=i("./app/components/pagination.tsx"),c=i("./app/components/emptyStateWarning.tsx"),p=i("./app/components/loadingIndicator.tsx"),d=i("./app/components/panels/index.tsx"),u=i("../node_modules/@sentry/core/esm/exports.js"),m=i("../node_modules/gl-matrix/esm/vec2.js"),f=i("./app/components/button.tsx"),g=i("./app/components/profiling/flamegraph/flamegraphZoomView.tsx"),h=i("./app/locale.tsx"),x=i("./app/styles/space.tsx"),y=i("./app/utils.tsx"),v=i("./app/utils/profiling/canvasScheduler.tsx"),w=i("./app/utils/profiling/canvasView.tsx"),Z=i("./app/utils/profiling/flamegraph.ts"),b=i("./app/utils/profiling/flamegraph/hooks/useFlamegraphPreferences.ts"),k=i("./app/utils/profiling/flamegraph/hooks/useFlamegraphProfiles.tsx"),j=i("./app/utils/profiling/flamegraph/hooks/useFlamegraphState.ts"),_=i("./app/utils/profiling/flamegraph/hooks/useFlamegraphZoomPosition.tsx"),S=i("./app/utils/profiling/flamegraph/useFlamegraphTheme.ts"),z=i("./app/utils/profiling/flamegraphCanvas.tsx"),P=i("./app/utils/profiling/gl/utils.ts"),I=i("./app/utils/profiling/renderers/flamegraphRendererWebGL.tsx"),E=i("./app/utils/profiling/speedscope.tsx"),q=i("./app/utils/useDevicePixelRatio.tsx"),T=i("./app/utils/useMemoWithPrevious.ts"),C=i("./app/views/profiling/profileGroupProvider.tsx"),F=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const A=Z.O.Empty();function L(){const e=(0,q.j)(),t=(0,j.T)(),i=(0,C.A)(),n=(0,S.W)(),o=(0,S.P)(),s=(0,_.I)(),a=(0,k.X)(),{colorCoding:l,sorting:c,view:p}=(0,b.K)(),{threadId:d,highlightFrames:x}=a,[L,R]=(0,r.useState)(null),[D,O]=(0,r.useState)(null),B=(0,r.useMemo)((()=>new v.o$),[]),H=(0,v.IZ)(B),W=(0,r.useMemo)((()=>i.profiles.find((e=>e.threadId===d))),[i,d]),G=(0,r.useMemo)((()=>{if("number"!=typeof d)return A;if(!W)return A;const e=u.Yr({op:"import",name:"flamegraph.constructor"});e.setTag("sorting",c.split(" ").join("_")),e.setTag("view",p.split(" ").join("_"));const t=new Z.O(W,d,{inverted:"bottom up"===p,sort:c,configSpace:void 0});return e.finish(),t}),[W,c,d,p]),N=(0,r.useMemo)((()=>{if(!L)return null;const t=n.SIZES.TIMELINE_HEIGHT*e;return new z.c(L,m.al(0,t))}),[e,L,n]),X=(0,T.P)((e=>{if(!N)return null;const t=new w.i({canvas:N,model:G,options:{inverted:G.inverted,minWidth:G.profile.minFrameDuration,barHeight:n.SIZES.BAR_HEIGHT,depthOffset:n.SIZES.FLAMEGRAPH_DEPTH_OFFSET,configSpaceTransform:void 0}});if((0,y.ri)(x)){const e=G.findAllMatchingFrames(x.name,x.package);if(e.length>0){const i=e.map((e=>new E.UL(e.start,e.depth,e.end-e.start,1))),n=(0,P.v5)(t.configView,i);return t.setConfigView(n),t}}else(0,y.ri)(x)||!s.view||s.view.isEmpty()||e?.model!==A||t.setConfigView(s.view,{width:{min:0}});return t}),[G,N,n]);(0,r.useEffect)((()=>{const e=N?.logicalSpace.height;e&&o((t=>{const i=e/G.depth/t.SIZES.BAR_HEIGHT,n=Math.min(Math.max(.8,i),1);return t.SIZES.FLAMEGRAPH_DEPTH_OFFSET=2.5,t.SIZES.BAR_HEIGHT=t.SIZES.BAR_HEIGHT*n,t.SIZES.BAR_FONT_SIZE=t.SIZES.BAR_FONT_SIZE*n,t}))}),[G,o]),(0,r.useLayoutEffect)((()=>{if(!N||!X)return;const e=(e,t)=>{t===X&&X.setConfigView(e.withHeight(X.configView.height)),B.draw()},t=(e,t)=>{t===X&&X.transformConfigView(e),B.draw()},i=()=>{X.resetConfigView(N),B.draw()},n=(e,t)=>{const i=(0,P.SO)(t,X.configView,new E.UL(e.start,e.depth,e.end-e.start,1)).transformRect(X.configSpaceTransform);X.setConfigView(i),B.draw()};return H.on("set config view",e),H.on("transform config view",t),H.on("reset zoom",i),H.on("zoom at frame",n),()=>{H.off("set config view",e),H.off("transform config view",t),H.off("reset zoom",i),H.off("zoom at frame",n)}}),[B,N,X,H]);const Q=(0,r.useMemo)((()=>[L,D]),[L,D]),V=(0,P.DB)(Q,B,N,X),$=(0,r.useMemo)((()=>L?new I.l(L,G,n,{colorCoding:l,draw_border:!0}):null),[l,G,L,n]);return(0,r.useEffect)((()=>{if((0,y.ri)(a.threadId))return;const e="number"==typeof i.activeProfileIndex?i.profiles[i.activeProfileIndex]?.threadId:null;if(x){const n=i.profiles.reduce(((t,i)=>{if(t?.isActiveThread)return t;const n=function(e,t){if(null===t)return null;let i=null;const n=[...e.root.children];for(;n.length>0;){const e=n.pop();if(t.name===e.frame.name&&(t.package===(e.frame.package||"")||t.package===(e.frame.module||""))&&(i?.node?.totalWeight||0)<e.node.totalWeight&&(i=e),i&&i.node.totalWeight<e.node.totalWeight)for(let t=0;t<e.children.length;t++)n.push(e.children[t])}return i}(new Z.O(i,i.threadId,{inverted:!1,sort:c,configSpace:void 0}),x);if(!(0,y.ri)(n))return t;const r=n.node.totalWeight||0,o=t?.frame?.node?.totalWeight||0;return r>0&&i.threadId===e?{frame:n,threadId:i.threadId,isActiveThread:!0}:r<=o?t:{frame:n,threadId:i.threadId}}),null);if((0,y.ri)(n))return void t({type:"set thread id",payload:n.threadId})}(0,y.ri)(e)&&t({type:"set thread id",payload:e})}),[i,x,a.threadId,t,c]),(0,F.BX)(r.Fragment,{children:[(0,F.tZ)(g.L,{canvasBounds:V,canvasPoolManager:B,flamegraph:G,flamegraphRenderer:$,flamegraphCanvas:N,flamegraphCanvasRef:L,flamegraphOverlayCanvasRef:D,flamegraphView:X,setFlamegraphCanvasRef:R,setFlamegraphOverlayCanvasRef:O,disablePanX:!0,disableZoom:!0,disableGrid:!0,disableCallOrderSort:!0}),(0,F.tZ)(M,{children:(0,F.tZ)(f.zx,{size:"xs",onClick:()=>H.dispatch("reset zoom"),children:(0,h.t)("Reset Zoom")})})]})}L.displayName="AggregateFlamegraph";const M=(0,n.Z)("div",{target:"e18qe88l0"})("position:absolute;left:0;top:0;padding:",(0,x.D)(1),";padding-left:",(0,x.D)(1),";background-color:rgba(255, 255, 255, 0.6);width:100%;");var R=i("./app/components/profiling/flex.tsx"),D=i("./app/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphContextProvider.tsx"),O=i("./app/utils/profiling/flamegraph/flamegraphThemeProvider.tsx"),B=i("./app/components/organizations/pageFilters/parse.tsx"),H=i("./app/utils/profiling/hooks/useCurrentProjectFromRouteParam.tsx"),W=i("./app/utils/queryClient.tsx"),G=i("./app/utils/tokenizeSearch.tsx"),N=i("./app/utils/useOrganization.tsx"),X=i("./app/utils/usePageFilters.tsx");function Q(e){let{transaction:t}=e;const{data:i,isLoading:n}=function(e){let{transaction:t}=e;const{selection:i}=(0,X.Z)(),n=(0,N.Z)(),r=(0,H.y)(),o=`/projects/${n.slug}/${r?.slug}/profiling/flamegraph/`,s=new G.MY([]);return s.setFilterValues("transaction_name",[t]),(0,W.aM)([o,{query:{query:s.formatString(),...(0,B.fK)(i.datetime)}}],{staleTime:0,retry:!1,enabled:Boolean(n?.slug&&r?.slug&&i.datetime)})}({transaction:t}),r=0===i?.shared.frames.length;return(0,F.tZ)(C.D,{type:"flamegraph",input:i??null,traceID:"",children:(0,F.tZ)(D.H,{initialState:{preferences:{sorting:"alphabetical",view:"bottom up"}},children:(0,F.tZ)(O.s6,{children:(0,F.tZ)(d.s_,{children:(0,F.tZ)(R.k,{h:400,column:!0,justify:"center",children:n?(0,F.tZ)(p.Z,{children:(0,h.t)("Loading Flamegraph")}):r?(0,F.tZ)(c.Z,{children:(0,F.tZ)("p",{children:(0,h.t)("A flamegraph isn't available for your query")})}):(0,F.tZ)(L,{})})})})})})}Q.displayName="AggregateFlamegraphPanel";var V=i("./app/components/profiling/profileEventsTable.tsx"),$=i("./app/components/profiling/suspectFunctions/suspectFunctionsTable.tsx"),K=i("./app/data/platformCategories.tsx"),U=i("./app/utils/profiling/hooks/useProfileEvents.tsx"),Y=i("./app/utils/queryString.tsx"),J=i("./app/views/profiling/landing/profileCharts.tsx");function ee(e){const t=(0,N.Z)(),i=(0,r.useMemo)((()=>te(e.project.platform)),[e.project]),n=(0,r.useMemo)((()=>(0,Y.ro)(e.location.query.cursor)),[e.location.query.cursor]),l=(0,U.kq)((0,Y.ro)(e.location.query.sort),i,{key:"timestamp",order:"desc"}),c=(0,U.GP)({cursor:n,fields:i,query:e.query,sort:l,limit:5,referrer:"api.profiling.profile-summary-table"}),p=(0,r.useCallback)((t=>{o.browserHistory.push({...e.location,query:{...e.location.query,cursor:void 0,sort:t}})}),[e.location]),d=t.features.includes("profiling-aggregate-flamegraph");return(0,F.tZ)(r.Fragment,{children:(0,F.BX)(a.or,{fullWidth:!0,children:[(0,F.tZ)(J.A,{query:e.query,hideCount:!0,compact:d}),d&&(0,F.tZ)(Q,{transaction:e.transaction}),(0,F.BX)(oe,{children:[(0,F.tZ)(s.Z,{triggerProps:{prefix:(0,h.t)("Filter"),size:"xs"},value:"asc"===l.order?l.key:`-${l.key}`,options:re,onChange:e=>p(e.value)}),(0,F.tZ)(se,{pageLinks:"success"===c.status?c.data?.[2]?.getResponseHeader("Link")??null:null,size:"xs"})]}),(0,F.tZ)(V.Q,{columns:i,data:"success"===c.status?c.data[0]:null,error:"error"===c.status?(0,h.t)("Unable to load profiles"):null,isLoading:"loading"===c.status,sort:l}),(0,F.tZ)($.f,{project:e.project,transaction:e.transaction,analyticsPageSource:"profiling_transaction"})]})})}function te(e){return K.ai.includes(e)?ie:ne}ee.displayName="ProfileSummaryContent";const ie=["profile.id","timestamp","release","device.model","device.classification","device.arch","transaction.duration"],ne=["profile.id","timestamp","release","transaction.duration"],re=[{label:(0,h.t)("Recent Profiles"),value:"-timestamp"},{label:(0,h.t)("Slowest Profiles"),value:"-transaction.duration"},{label:(0,h.t)("Fastest Profiles"),value:"transaction.duration"}],oe=(0,n.Z)("div",{target:"etsf1iv1"})("display:flex;justify-content:space-between;margin-bottom:",(0,x.D)(1),";"),se=(0,n.Z)(l.Z,{target:"etsf1iv0"})("margin:0 0 0 ",(0,x.D)(1),";")}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_components_dataZoomInside_tsx-app_components_charts_components_toolBox_-9c2fbe.b59fdcd638282b3f4efa239ddcc52b63.js.map