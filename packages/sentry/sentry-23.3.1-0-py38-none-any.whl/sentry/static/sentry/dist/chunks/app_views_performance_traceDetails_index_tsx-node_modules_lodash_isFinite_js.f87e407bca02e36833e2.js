(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_traceDetails_index_tsx-node_modules_lodash_isFinite_js"],{"./app/utils/fuzzySearch.tsx":(e,t,r)=>{"use strict";r.d(t,{I:()=>a}),r("../node_modules/core-js/modules/es.error.cause.js");const s={includeScore:!0,includeMatches:!0,threshold:.4,location:0,distance:75,minMatchCharLength:2};async function a(e,t){if(!t.keys)throw new Error("You need to define `options.keys`");return new((await r.e("vendors-node_modules_fuse_js_dist_fuse_esm_js").then(r.bind(r,"../node_modules/fuse.js/dist/fuse.esm.js"))).default)(e,{...s,...t})}},"./app/utils/performance/quickTrace/traceFullQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{H:()=>u,g:()=>l});var s=r("../node_modules/react/index.js"),a=r("./app/utils/discover/genericDiscoverQuery.tsx"),n=r("./app/utils/performance/quickTrace/utils.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{detailed:t,eventId:r,...s}=e;const a=(0,n.eF)(s);return a.detailed=t?"1":"0",r&&(a.event_id=r),a}function c(e){let{children:t}=e;return(0,i.tZ)(s.Fragment,{children:t({isLoading:!1,error:null,traces:null,type:"full"})})}function d(e){let{traceId:t,start:r,end:s,statsPeriod:d,children:l,...u}=e;if(!t)return(0,i.tZ)(c,{children:l});const p=(0,n._Z)({start:r,end:s,statsPeriod:d});return(0,i.tZ)(a.ZP,{route:`events-trace/${t}`,getRequestPayload:o,eventView:p,...u,children:e=>{let{tableData:t,...r}=e;return l({traces:t||null,type:"full",...r})}})}c.displayName="EmptyTrace",d.displayName="GenericTraceFullQuery";const l=e=>(0,i.tZ)(d,{...e,detailed:!1});l.displayName="TraceFullQuery";const u=e=>(0,i.tZ)(d,{...e,detailed:!0});u.displayName="TraceFullDetailedQuery"},"./app/utils/performance/quickTrace/traceMetaQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var s=r("../node_modules/react/index.js"),a=r("./app/utils/discover/genericDiscoverQuery.tsx"),n=r("./app/utils/performance/quickTrace/utils.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{traceId:t,start:r,end:o,statsPeriod:c,children:d,...l}=e;if(!t)return(0,i.tZ)(s.Fragment,{children:d({isLoading:!1,error:null,meta:null})});const u=(0,n._Z)({start:r,end:o,statsPeriod:c});return(0,i.tZ)(a.ZP,{route:`events-trace-meta/${t}`,getRequestPayload:n.eF,eventView:u,...l,children:e=>{let{tableData:t,...r}=e;return d({meta:t,...r})}})}o.displayName="TraceMetaQuery";const c=o},"./app/views/performance/traceDetails/index.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>U});var s=r("../node_modules/react/index.js"),a=r("./app/components/layouts/thirds.tsx"),n=r("./app/components/noProjectMessage.tsx"),i=r("./app/components/organizations/pageFilters/parse.tsx"),o=r("./app/components/sentryDocumentTitle.tsx"),c=r("./app/constants/pageFilters.tsx"),d=r("./app/locale.tsx"),l=r("./app/utils/discover/eventView.tsx"),u=r("./app/utils/discover/genericDiscoverQuery.tsx"),p=r("./app/utils/performance/quickTrace/traceFullQuery.tsx"),h=r("./app/utils/performance/quickTrace/traceMetaQuery.tsx"),m=r("./app/utils/queryString.tsx"),g=r("./app/utils/withApi.tsx"),f=r("./app/utils/withOrganization.tsx"),x=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),Z=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),y=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.array.push.js"),r("./app/components/alert.tsx")),T=r("./app/components/assistant/guideAnchor.tsx"),v=r("./app/components/buttonBar.tsx"),w=r("./app/components/discoverButton.tsx"),_=r("./app/components/links/externalLink.tsx"),b=r("./app/components/loadingError.tsx"),S=r("./app/components/loadingIndicator.tsx"),j=r("./app/components/timeSince.tsx"),D=r("./app/styles/space.tsx"),k=r("./app/utils.tsx"),F=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),P=r("./app/utils/formatters.tsx"),I=r("./app/utils/fuzzySearch.tsx"),z=r("./app/utils/getDynamicText.tsx"),q=r("./app/utils/performance/quickTrace/utils.tsx"),Q=r("./app/utils/performanceForSentry.tsx"),E=r("./app/views/performance/breadcrumb.tsx"),L=r("./app/views/performance/transactionDetails/styles.tsx"),V=r("./app/views/performance/traceDetails/styles.tsx"),B=r("./app/views/performance/traceDetails/traceNotFound.tsx"),C=r("./app/views/performance/traceDetails/traceView.tsx"),M=r("./app/views/performance/traceDetails/utils.tsx"),R=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class N extends s.Component{constructor(){super(...arguments),(0,x.Z)(this,"state",{searchQuery:void 0,filteredTransactionIds:void 0}),(0,x.Z)(this,"fuse",null),(0,x.Z)(this,"traceViewRef",(0,s.createRef)()),(0,x.Z)(this,"virtualScrollbarContainerRef",(0,s.createRef)()),(0,x.Z)(this,"handleTransactionFilter",(e=>{this.setState({searchQuery:e||void 0},this.filterTransactions)})),(0,x.Z)(this,"filterTransactions",(()=>{const{traces:e}=this.props,{filteredTransactionIds:t,searchQuery:r}=this.state;if(!r||null===e||e.length<=0||!(0,k.ri)(this.fuse))return void(void 0!==t&&this.setState({filteredTransactionIds:void 0}));const s=this.fuse.search(r).filter((e=>{let{matches:t}=e;return t?.length})).map((e=>{let{item:t}=e;return t.transaction.event_id})),a=e.flatMap((e=>(0,q.xB)(e,(e=>{let{event_id:t,span_id:s}=e;return t.includes(r)||s.includes(r)})))).map((e=>e.event_id));this.setState({filteredTransactionIds:new Set([...s,...a])})}))}componentDidMount(){this.initFuse()}componentDidUpdate(e){this.props.traces!==e.traces&&this.initFuse()}async initFuse(){if((0,k.ri)(this.props.traces)&&this.props.traces.length>0){const e=this.props.traces.flatMap((e=>(0,q.S2)(e,((e,t)=>{const r=[t["transaction.op"],t.transaction,t.project_slug];return e.push({transaction:t,indexed:r}),e}),[])));this.fuse=await(0,I.I)(e,{keys:["indexed"],includeMatches:!0,threshold:.6,location:0,distance:100,maxPatternLength:32})}}renderTraceLoading(){return(0,R.tZ)(S.Z,{})}renderTraceRequiresDateRangeSelection(){return(0,R.tZ)(b.Z,{message:(0,d.t)("Trace view requires a date range selection.")})}renderSearchBar(){return(0,R.tZ)(V.pH,{children:(0,R.tZ)(V.Iq,{defaultQuery:"",query:this.state.searchQuery||"",placeholder:(0,d.t)("Search for transactions"),onSearch:this.handleTransactionFilter})})}renderTraceHeader(e){const{meta:t}=this.props;return(0,R.BX)(V.Z9,{children:[(0,R.tZ)(T.Z,{target:"trace_view_guide_breakdown",children:(0,R.tZ)(L.U,{headingText:(0,d.t)("Event Breakdown"),tooltipText:(0,d.t)("The number of transactions and errors there are in this trace."),bodyText:(0,d._N)("[transactions]  |  [errors]",{transactions:(0,d.tn)("%s Transaction","%s Transactions",t?.transactions??e.transactions.size),errors:(0,d.tn)("%s Error","%s Errors",t?.errors??e.errors.size)}),subtext:(0,d.tn)("Across %s project","Across %s projects",t?.projects??e.projects.size)})}),(0,R.tZ)(L.U,{headingText:(0,d.t)("Total Duration"),tooltipText:(0,d.t)("The time elapsed between the start and end of this trace."),bodyText:(0,P.g9)(e.endTimestamp-e.startTimestamp,2,!0),subtext:(0,z.Z)({value:(0,R.tZ)(j.Z,{date:1e3*(e.endTimestamp||0)}),fixed:"5 days ago"})})]})}renderTraceWarnings(){const{traces:e}=this.props,{roots:t,orphans:r}=(e??[]).reduce(((e,t)=>((0,M.uM)(t)?e.roots++:e.orphans++,e)),{roots:0,orphans:0});let s=null;return 0===t&&r>0?s=(0,R.tZ)(y.bZ,{type:"info",showIcon:!0,children:(0,R.tZ)(_.Z,{href:"https://docs.sentry.io/product/performance/trace-view/#orphan-traces-and-broken-subtraces",children:(0,d.t)("A root transaction is missing. Transactions linked by a dashed line have been orphaned and cannot be directly linked to the root.")})}):1===t&&r>0?s=(0,R.tZ)(y.bZ,{type:"info",showIcon:!0,children:(0,R.tZ)(_.Z,{href:"https://docs.sentry.io/product/performance/trace-view/#orphan-traces-and-broken-subtraces",children:(0,d.t)("This trace has broken subtraces. Transactions linked by a dashed line have been orphaned and cannot be directly linked to the root.")})}):t>1&&(s=(0,R.tZ)(y.bZ,{type:"info",showIcon:!0,children:(0,R.tZ)(_.Z,{href:"https://docs.sentry.io/product/sentry-basics/tracing/trace-view/#multiple-roots",children:(0,d.t)("Multiple root transactions have been found with this trace ID.")})})),s}renderContent(){const{dateSelected:e,isLoading:t,error:r,organization:a,location:n,traceEventView:i,traceSlug:o,traces:c,meta:d}=this.props;if(!e)return this.renderTraceRequiresDateRangeSelection();if(t)return this.renderTraceLoading();if(null!==r||null===c||c.length<=0)return(0,R.tZ)(B.Z,{meta:d,traceEventView:i,traceSlug:o,location:n,organization:a});const l=(0,M.Rg)(c);return(0,R.BX)(s.Fragment,{children:[this.renderTraceWarnings(),this.renderTraceHeader(l),this.renderSearchBar(),(0,R.tZ)(A,{children:(0,R.tZ)(Q.oF,{id:"PerformanceDetails-TraceView",hasData:!!c.length,children:(0,R.tZ)(C.Z,{filteredTransactionIds:this.state.filteredTransactionIds,traceInfo:l,location:n,organization:a,traceEventView:i,traceSlug:o,traces:c,meta:d})})})]})}render(){const{organization:e,location:t,traceEventView:r,traceSlug:n}=this.props;return(0,R.BX)(s.Fragment,{children:[(0,R.BX)(a.h4,{children:[(0,R.BX)(a.oB,{children:[(0,R.tZ)(E.Z,{organization:e,location:t,traceSlug:n}),(0,R.tZ)(a.Dx,{"data-test-id":"trace-header",children:(0,d.t)("Trace ID: %s",n)})]}),(0,R.tZ)(a.kP,{children:(0,R.tZ)(v.ZP,{gap:1,children:(0,R.tZ)(w.Z,{size:"sm",to:r.getResultsViewUrlTarget(e.slug),onClick:()=>{(0,F.Z)("performance_views.trace_view.open_in_discover",{organization:e})},children:(0,d.t)("Open in Discover")})})})]}),(0,R.tZ)(a.uT,{children:(0,R.tZ)(a.or,{fullWidth:!0,children:this.renderContent()})})]})}}N.displayName="TraceDetailsContent";const A=(0,Z.Z)("div",{target:"epic5s0"})("margin-top:",(0,D.D)(2),";"),H=N;class X extends s.Component{getDocumentTitle(){return[(0,d.t)("Trace Details"),(0,d.t)("Performance")].join(" - ")}getTraceSlug(){const{traceSlug:e}=this.props.params;return"string"==typeof e?e.trim():""}getDateSelection(){const{location:e}=this.props,t=(0,i.fK)(e.query,{allowAbsolutePageDatetime:!0});return{start:(0,m.ro)(t.start),end:(0,m.ro)(t.end),statsPeriod:(0,m.ro)(t.statsPeriod)}}getTraceEventView(){const e=this.getTraceSlug(),{start:t,end:r,statsPeriod:s}=this.getDateSelection();return l.ZP.fromSavedQuery({id:void 0,name:`Events with Trace ID ${e}`,fields:["title","event.type","project","timestamp"],orderby:"-timestamp",query:`trace:${e}`,projects:[c.mP],version:2,start:t,end:r,range:s})}renderContent(){const{location:e,organization:t,params:r}=this.props,s=this.getTraceSlug(),{start:a,end:n,statsPeriod:i}=this.getDateSelection(),o=Boolean(i||a&&n),c=a=>{let{isLoading:n,error:i,traces:c,meta:d}=a;return(0,R.tZ)(H,{location:e,organization:t,params:r,traceSlug:s,traceEventView:this.getTraceEventView(),dateSelected:o,isLoading:n,error:i,traces:c,meta:d})};return o?(0,R.tZ)(p.H,{location:e,orgSlug:t.slug,traceId:s,start:a,end:n,statsPeriod:i,children:r=>(0,R.tZ)(h.Z,{location:e,orgSlug:t.slug,traceId:s,start:a,end:n,statsPeriod:i,children:e=>c({isLoading:r.isLoading||e.isLoading,error:r.error||e.error,traces:r.traces,meta:e.meta})})}):c({isLoading:!1,error:new u.o("date selection not specified"),traces:null,meta:null})}render(){const{organization:e}=this.props;return(0,R.tZ)(o.Z,{title:this.getDocumentTitle(),orgSlug:e.slug,children:(0,R.tZ)(a.T3,{children:(0,R.tZ)(n.Z,{organization:e,children:this.renderContent()})})})}}X.displayName="TraceSummary";const U=(0,f.Z)((0,g.Z)(X))},"../node_modules/lodash/isFinite.js":(e,t,r)=>{var s=r("../node_modules/lodash/_root.js").isFinite;e.exports=function(e){return"number"==typeof e&&s(e)}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_traceDetails_index_tsx-node_modules_lodash_isFinite_js.bb8e1e6b3ec394d9adff69cccb44acd8.js.map