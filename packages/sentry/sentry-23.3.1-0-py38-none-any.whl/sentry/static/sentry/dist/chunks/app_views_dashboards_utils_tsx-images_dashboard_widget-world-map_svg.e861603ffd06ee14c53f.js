"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_dashboards_utils_tsx-images_dashboard_widget-world-map_svg"],{"./app/components/arithmeticInput/parser.tsx":(e,t,r)=>{r.d(t,{W9:()=>p});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.array.push.js"),r("../node_modules/core-js/modules/es.error.cause.js"),r("./app/locale.tsx")),o=r("./app/components/arithmeticInput/grammar.pegjs"),i=r.n(o);const u=(0,s.t)("Maximum operators exceeded");class a{constructor(e){let{operator:t,lhs:r=null,rhs:s}=e;(0,n.Z)(this,"operator",void 0),(0,n.Z)(this,"lhs",void 0),(0,n.Z)(this,"rhs",void 0),this.operator=t,this.lhs=r,this.rhs=s}}class c{constructor(e){let{term:t,location:r}=e;(0,n.Z)(this,"term",void 0),(0,n.Z)(this,"location",void 0),this.term=t,this.location=r}}class l{constructor(){(0,n.Z)(this,"numOperations",void 0),(0,n.Z)(this,"errors",void 0),(0,n.Z)(this,"fields",void 0),(0,n.Z)(this,"functions",void 0),(0,n.Z)(this,"tokenTerm",((e,t)=>t.length>0?(t[0].lhs=e,d(t)):e)),(0,n.Z)(this,"tokenOperation",((e,t)=>(this.numOperations+=1,this.numOperations>10&&!this.errors.includes(u)&&this.errors.push(u),"divide"===e&&"0"===t&&this.errors.push((0,s.t)("Division by 0 is not allowed")),new a({operator:e,rhs:t})))),(0,n.Z)(this,"tokenFactor",((e,t)=>(t[0].lhs=e,d(t)))),(0,n.Z)(this,"tokenField",((e,t)=>{const r=new c({term:e,location:t});return this.fields.push(r),e})),(0,n.Z)(this,"tokenFunction",((e,t)=>{const r=new c({term:e,location:t});return this.functions.push(r),e})),this.numOperations=0,this.errors=[],this.fields=[],this.functions=[]}}function d(e){let t=e.shift();for(;e.length>0;){const r=e.shift();r&&t&&null===r.lhs&&(r.lhs=t),t=r}if(void 0===t)throw new Error("Unable to parse arithmetic");return t}function p(e){const t=new l;try{return{result:i().parse(e,{tc:t}),error:t.errors[0],tc:t}}catch(e){return{result:null,error:e.message,tc:t}}}},"./app/utils/measurements/measurements.tsx":(e,t,r)=>{r.d(t,{Z:()=>d,i:()=>c});var n=r("../node_modules/react/index.js"),s=r("./app/utils/performance/vitals/constants.tsx"),o=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){return Object.fromEntries(Object.entries(e).map((e=>{let[t,r]=e;return[t,{name:r.name,key:t}]})))}const u=i(s.TT),a=i(s.r9);function c(){return{...a,...u}}function l(e){let{children:t}=e;const r=c();return(0,o.tZ)(n.Fragment,{children:t({measurements:r})})}l.displayName="Measurements";const d=l},"./app/views/dashboards/utils.tsx":(e,t,r)=>{r.d(t,{qk:()=>C,y1:()=>S,DF:()=>B,tT:()=>k,Tk:()=>R,EK:()=>V,lM:()=>Y,Gl:()=>D,Mf:()=>E,yd:()=>M,fK:()=>N,aq:()=>G,z1:()=>T,s:()=>Z,hS:()=>$,Cg:()=>P,Lo:()=>I,S$:()=>L,nk:()=>z,Gx:()=>X,Z5:()=>U}),r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.array.push.js"),r("../node_modules/core-js/modules/es.array.unshift.js");var n=r("../node_modules/react-router/es/index.js"),s=r("../node_modules/lodash/cloneDeep.js"),o=r.n(s),i=r("../node_modules/lodash/isEmpty.js"),u=r.n(i),a=r("../node_modules/lodash/isEqual.js"),c=r.n(a),l=r("../node_modules/lodash/pick.js"),d=r.n(l),p=r("../node_modules/lodash/trimStart.js"),f=r.n(p),h=r("../node_modules/query-string/index.js");r.p;var m=r("./app/components/arithmeticInput/parser.tsx"),g=r("./app/components/charts/utils.tsx"),v=r("./app/components/organizations/pageFilters/parse.tsx"),y=r("./app/components/searchSyntax/parser.tsx"),A=r("./app/utils.tsx"),x=r("./app/utils/dates.tsx"),j=r("./app/utils/discover/eventView.tsx"),b=r("./app/utils/discover/fields.tsx"),w=r("./app/utils/discover/types.tsx"),q=r("./app/utils/measurements/measurements.tsx"),_=r("./app/utils/queryString.tsx"),O=r("./app/views/dashboards/types.tsx");function C(e){return o()(e)}function k(e,t,r,n){const{start:s,end:o,period:i}=r.datetime,{projects:u,environments:a}=r,c=n!==O.FO.WORLD_MAP||t.columns.includes("geo.country_code")?[...t.columns,...t.aggregates]:["geo.country_code",...t.columns,...t.aggregates],l=n!==O.FO.WORLD_MAP||t.conditions.includes("has:geo.country_code")?t.conditions:`${t.conditions} has:geo.country_code`.trim(),{orderby:d}=t,p=d?`${d.startsWith("-")?"-":""}${(0,b.LY)(f()(d,"-"))}`:d;return j.ZP.fromSavedQuery({id:void 0,name:e,version:2,fields:c,query:l,orderby:p,projects:u,range:i??void 0,start:s?(0,x.v5)(s):void 0,end:o?(0,x.v5)(o):void 0,environment:a})}function F(e){return"string"==typeof e?[e]:e}function S(e){if(e){const t=F(e.queryNames),r=F(e.queryConditions),n=F(e.queryFields),s=[];if(r&&t&&n&&"string"==typeof e.queryOrderby){const{columns:o,aggregates:i}=(0,b.n0)(n);r.forEach(((r,u)=>{s.push({name:t[u],conditions:r,fields:n,columns:o,aggregates:i,orderby:e.queryOrderby})}))}if(e.title&&e.displayType&&e.interval&&s.length>0)return{...d()(e,["title","displayType","interval"]),widgetType:O.l9.DISCOVER,queries:s}}}function Z(e,t,r,n){let s="bar"===e?"1d":r;s||(s="5m");const o=(0,x.YJ)(s),i=(0,g.Nm)(t);if(n)return s=(0,g.ZS)(t,n),i>g.aC&&i<=g.w3&&(s="1h"),"bar"===e?"1d":s;if(i/(60*o)>66){const e=(0,g.ZS)(t,"high");if(o<(0,x.YJ)(e))return e}return s}function E(e){const t=new Set;return e.filter(b.GO).forEach((e=>{const r=(0,m.W9)((0,b.bQ)(e)).tc;r.fields.forEach((e=>{let{term:r}=e;return t.add(r)})),r.functions.forEach((e=>{let{term:r}=e;return t.add(r)}))})),Array.from(t)}function T(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=k(e.title,e.queries[n],t,e.displayType),i=o.getResultsViewUrlTarget(r.slug),u=o.getYAxisOptions().map((e=>{let{value:t}=e;return t}));switch(i.query.yAxis=[...new Set(e.queries[0].aggregates.filter((e=>u.includes(e))))].slice(0,3),e.displayType){case O.FO.WORLD_MAP:i.query.display=w.DC.WORLDMAP;break;case O.FO.BAR:i.query.display=w.DC.BAR;break;case O.FO.TOP_N:i.query.display=w.DC.TOP5;const t=e.queries[0].aggregates;i.query.yAxis=t[t.length-1],t.slice(0,-1).includes(t[t.length-1])&&(i.query.field=t.slice(0,-1))}const a=i.query.field,c=e.queries[0],l=(0,A.ri)(c.fields)?c.fields:[...c.columns,...c.aggregates],d=E(l);d.forEach((e=>{Array.isArray(a)&&!a.includes(e)&&a.unshift(e)})),s&&(i.query.fromMetric="true");const p=`${i.pathname}?${h.stringify({...i.query})}`;return p}function $(e,t,r){const{start:n,end:s,utc:o,period:i}=t.datetime,u=n&&s?{start:(0,x.v5)(n),end:(0,x.v5)(s),utc:o}:{statsPeriod:i};return`/organizations/${r.slug}/issues/?${h.stringify({query:e.queries?.[0]?.conditions,sort:e.queries?.[0]?.orderby,...u,project:t.projects,environment:t.environments})}`}function P(e,t,r){const{start:n,end:s,utc:o,period:i}=t.datetime,u=n&&s?{start:(0,x.v5)(n),end:(0,x.v5)(s),utc:o}:{statsPeriod:i};return`/organizations/${r.slug}/releases/?${h.stringify({...u,project:t.projects,environment:t.environments})}`}function R(e,t){return"string"==typeof e?t.error=e:Object.keys(e).forEach((r=>{const n=e[r];"string"!=typeof n?Array.isArray(n)&&"string"==typeof n[0]?t[r]=n[0]:Array.isArray(n)&&"object"==typeof n[0]?n.map((e=>R(e,t))):R(n,t):t[r]=n})),t}function D(e){return e?{dataset:"metricsEnhanced"}:{}}function M(e){return e.filter(b.GO).length}const W=new Set(Object.keys((0,q.i)()));function z(e){return!W.has(e)&&(0,b.Xr)(e)}function X(e){return e.widgetType===O.l9.DISCOVER&&e.queries.some((e=>{let{aggregates:t,columns:r,fields:n,conditions:s}=e;const o=[...t.reduce(((e,t)=>{const r=(0,b.hW)(t);return r&&e.push(r),e}),[]),...r,...n??[]].some((e=>"transaction"===e)),i=(0,y.UG)(s)?.some((e=>e.type===y.WU.Filter&&"transaction"===e.key?.text));return o||i}))}function I(e){return!(u()(e.projects)&&void 0===e.environment&&void 0===e.start&&void 0===e.end&&void 0===e.period)}function L(e,t){const r={projects:new Set(e.projects),environment:new Set(e.environment),period:e.period,start:(0,v.gX)(e.start),end:(0,v.gX)(e.end),utc:e.utc};let n={...V(t)};return n={...n,projects:new Set(n.projects),environment:new Set(n.environment)},(0,A.ri)(t.query?.release)&&(r.release=new Set(e.filters?.release),n.release=new Set(t.query?.release)),!c()(r,n)}function N(e){return{datetime:{end:e.end||null,period:e.period||null,start:e.start||null,utc:null},environments:e.environment||[],projects:e.projects||[]}}function G(e){return{project:e.projects,environment:e.environment,statsPeriod:e.period,start:(0,v.gX)(e.start),end:(0,v.gX)(e.end),utc:e.utc}}function U(e,t){n.browserHistory.replace({...t,query:G(e)})}function V(e){const{project:t,environment:r,statsPeriod:n,start:s,end:o,utc:i}=e.query??{};return{projects:null==t?[]:"string"==typeof t?[Number(t)]:t.map(Number),environment:"string"==typeof r?[r]:r??void 0,period:n,start:(0,A.ri)(s)?(0,v.gX)(s):void 0,end:(0,A.ri)(o)?(0,v.gX)(o):void 0,utc:(0,A.ri)(i)?"true"===i:void 0}}function Y(e){const t={};return Object.values(O.qA).forEach((r=>{(0,A.ri)(e.query?.[r])&&(t[r]=(0,_.qP)(e.query?.[r]))})),u()(t)?null:t}function B(e){let t="";if(e)for(const[r,n]of Object.entries(e))1===n.length?t+=`${r}:${n[0]} `:n.length>1&&(t+=`${r}:[${n.join(",")}] `);return t}},"./app/components/arithmeticInput/grammar.pegjs":e=>{function t(e,r,n,s){this.message=e,this.expected=r,this.found=n,this.location=s,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}!function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(t,Error),t.buildMessage=function(e,t){var r={literal:function(e){return'"'+s(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?o(e.parts[t][0])+"-"+o(e.parts[t][1]):o(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function s(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,s,o=new Array(e.length);for(t=0;t<e.length;t++)o[t]=(s=e[t],r[s.type](s));if(o.sort(),o.length>0){for(t=1,n=1;t<o.length;t++)o[t-1]!==o[t]&&(o[n]=o[t],n++);o.length=n}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(e)+" but "+function(e){return e?'"'+s(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:t,parse:function(e,r){r=void 0!==r?r:{};var n,s={},o={term:J},i=J,u=function(e,t){return ie.tokenOperation(e,t)},a=N("+",!1),c=N("-",!1),l=N("*",!1),d=/^[\/\xF7]/,p=G(["/","÷"],!1,!1),f=U("function"),h=U("number"),m=/^[+\-]/,g=G(["+","-"],!1,!1),v=/^[0-9]/,y=G([["0","9"]],!1,!1),A=N(".",!1),x=U("field"),j=/^[a-zA-Z_.]/,b=G([["a","z"],["A","Z"],"_","."],!1,!1),w=/^[^()\t\n, "]/,q=G(["(",")","\t","\n",","," ",'"'],!0,!1),_=N('"',!1),O='\\"',C=N('\\"',!1),k=/^[^\t\n"]/,F=G(["\t","\n",'"'],!0,!1),S=/^[a-zA-Z_0-9]/,Z=G([["a","z"],["A","Z"],"_",["0","9"]],!1,!1),E=N(",",!1),T=N("(",!1),$=N(")",!1),P=N(" ",!1),R=0,D=0,M=[{line:1,column:1}],W=0,z=[],X=0;if("startRule"in r){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');i=o[r.startRule]}function I(){return e.substring(D,R)}function L(){return Y(D,R)}function N(e,t){return{type:"literal",text:e,ignoreCase:t}}function G(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function U(e){return{type:"other",description:e}}function V(t){var r,n=M[t];if(n)return n;for(r=t-1;!M[r];)r--;for(n={line:(n=M[r]).line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return M[t]=n,n}function Y(e,t){var r=V(e),n=V(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function B(e){R<W||(R>W&&(W=R,z=[]),z.push(e))}function J(){var e,t,r,n,o;return e=R,(t=Q())!==s?(r=function(){var e,t;for(e=[],t=K();t!==s;)e.push(t),t=K();return e}(),r!==s?(D=e,n=t,o=r,e=t=ie.tokenTerm(n,o)):(R=e,e=s)):(R=e,e=s),e}function K(){var t,r,n;return t=R,r=function(){var t,r;return t=R,oe()!==s?(r=function(){var t,r;return t=R,43===e.charCodeAt(R)?(r="+",R++):(r=s,0===X&&B(a)),r!==s&&(D=t,r="plus"),r}(),r===s&&(r=function(){var t,r;return t=R,45===e.charCodeAt(R)?(r="-",R++):(r=s,0===X&&B(c)),r!==s&&(D=t,r="minus"),r}()),r!==s&&oe()!==s?(D=t,t=r):(R=t,t=s)):(R=t,t=s),t}(),r!==s&&(n=Q())!==s?(D=t,t=r=u(r,n)):(R=t,t=s),t}function Q(){var e,t;return e=R,oe()!==s?(t=function(){var e,t,r,n,o;return e=R,(t=ee())!==s?(r=function(){var e,t;if(e=[],(t=H())!==s)for(;t!==s;)e.push(t),t=H();else e=s;return e}(),r!==s?(D=e,n=t,o=r,e=t=ie.tokenFactor(n,o)):(R=e,e=s)):(R=e,e=s),e}(),t===s&&(t=ee()),t!==s&&oe()!==s?(D=e,e=t):(R=e,e=s)):(R=e,e=s),e}function H(){var t,r,n;return t=R,r=function(){var t,r;return t=R,oe()!==s?(r=function(){var t,r;return t=R,42===e.charCodeAt(R)?(r="*",R++):(r=s,0===X&&B(l)),r!==s&&(D=t,r="multiply"),r}(),r===s&&(r=function(){var t,r;return t=R,d.test(e.charAt(R))?(r=e.charAt(R),R++):(r=s,0===X&&B(p)),r!==s&&(D=t,r="divide"),r}()),r!==s&&oe()!==s?(D=t,t=r):(R=t,t=s)):(R=t,t=s),t}(),r!==s&&(n=ee())!==s?(D=t,t=r=u(r,n)):(R=t,t=s),t}function ee(){var t,r;return t=R,oe()!==s?(r=function(){var e,t;return e=R,ne()!==s&&(t=J())!==s&&se()!==s?(D=e,e=t):(R=e,e=s),e}(),r===s&&(r=function(){var t,r,n,o,i,u,a;if(X++,t=R,m.test(e.charAt(R))?(r=e.charAt(R),R++):(r=s,0===X&&B(g)),r===s&&(r=null),r!==s){if(n=[],v.test(e.charAt(R))?(o=e.charAt(R),R++):(o=s,0===X&&B(y)),o!==s)for(;o!==s;)n.push(o),v.test(e.charAt(R))?(o=e.charAt(R),R++):(o=s,0===X&&B(y));else n=s;if(n!==s){if(o=R,46===e.charCodeAt(R)?(i=".",R++):(i=s,0===X&&B(A)),i!==s){for(u=[],v.test(e.charAt(R))?(a=e.charAt(R),R++):(a=s,0===X&&B(y));a!==s;)u.push(a),v.test(e.charAt(R))?(a=e.charAt(R),R++):(a=s,0===X&&B(y));u!==s?o=i=[i,u]:(R=o,o=s)}else R=o,o=s;o===s&&(o=null),o!==s?(D=t,t=r=I()):(R=t,t=s)}else R=t,t=s}else R=t,t=s;return X--,t===s&&(r=s,0===X&&B(h)),t}(),r===s&&(r=function(){var t,r,n;return X++,t=R,r=function(){var t,r;if(t=[],S.test(e.charAt(R))?(r=e.charAt(R),R++):(r=s,0===X&&B(Z)),r!==s)for(;r!==s;)t.push(r),S.test(e.charAt(R))?(r=e.charAt(R),R++):(r=s,0===X&&B(Z));else t=s;return t}(),r!==s&&ne()!==s&&oe()!==s?(n=function(){var e,t,r,n,o,i,u,a;if(e=R,(t=te())!==s){for(r=[],n=R,(o=oe())!==s&&(i=re())!==s&&(u=oe())!==s&&(a=te())!==s?n=o=[o,i,u,a]:(R=n,n=s);n!==s;)r.push(n),n=R,(o=oe())!==s&&(i=re())!==s&&(u=oe())!==s&&(a=te())!==s?n=o=[o,i,u,a]:(R=n,n=s);r!==s?e=t=[t,r]:(R=e,e=s)}else R=e,e=s;return e}(),n===s&&(n=null),n!==s&&oe()!==s&&se()!==s?(D=t,t=r=ie.tokenFunction(I(),L())):(R=t,t=s)):(R=t,t=s),X--,t===s&&(r=s,0===X&&B(f)),t}(),r===s&&(r=function(){var t,r,n;if(X++,t=R,r=[],j.test(e.charAt(R))?(n=e.charAt(R),R++):(n=s,0===X&&B(b)),n!==s)for(;n!==s;)r.push(n),j.test(e.charAt(R))?(n=e.charAt(R),R++):(n=s,0===X&&B(b));else r=s;return r!==s&&(D=t,r=ie.tokenField(I(),L())),X--,(t=r)===s&&(r=s,0===X&&B(x)),t}()))),r!==s&&oe()!==s?(D=t,t=r):(R=t,t=s)):(R=t,t=s),t}function te(){var t;return(t=function(){var t,r,n,o;if(t=R,34===e.charCodeAt(R)?(r='"',R++):(r=s,0===X&&B(_)),r!==s){for(n=[],e.substr(R,2)===O?(o=O,R+=2):(o=s,0===X&&B(C)),o===s&&(k.test(e.charAt(R))?(o=e.charAt(R),R++):(o=s,0===X&&B(F)));o!==s;)n.push(o),e.substr(R,2)===O?(o=O,R+=2):(o=s,0===X&&B(C)),o===s&&(k.test(e.charAt(R))?(o=e.charAt(R),R++):(o=s,0===X&&B(F)));n!==s?(34===e.charCodeAt(R)?(o='"',R++):(o=s,0===X&&B(_)),o!==s?t=r=[r,n,o]:(R=t,t=s)):(R=t,t=s)}else R=t,t=s;return t}())===s&&(t=function(){var t,r;if(t=[],w.test(e.charAt(R))?(r=e.charAt(R),R++):(r=s,0===X&&B(q)),r!==s)for(;r!==s;)t.push(r),w.test(e.charAt(R))?(r=e.charAt(R),R++):(r=s,0===X&&B(q));else t=s;return t}()),t}function re(){var t;return 44===e.charCodeAt(R)?(t=",",R++):(t=s,0===X&&B(E)),t}function ne(){var t;return 40===e.charCodeAt(R)?(t="(",R++):(t=s,0===X&&B(T)),t}function se(){var t;return 41===e.charCodeAt(R)?(t=")",R++):(t=s,0===X&&B($)),t}function oe(){var t,r;for(t=[],32===e.charCodeAt(R)?(r=" ",R++):(r=s,0===X&&B(P));r!==s;)t.push(r),32===e.charCodeAt(R)?(r=" ",R++):(r=s,0===X&&B(P));return t}const{tc:ie,term:ue}=r;if((n=i())!==s&&R===e.length)return n;throw n!==s&&R<e.length&&B({type:"end"}),function(e,r,n){return new t(t.buildMessage(e,r),e,r,n)}(z,W<e.length?e.charAt(W):null,W<e.length?Y(W,W+1):Y(W,W))}}}}]);
//# sourceMappingURL=../sourcemaps/app_views_dashboards_utils_tsx-images_dashboard_widget-world-map_svg.6f187f0bb0a9c10c39d3ad67b7204e60.js.map