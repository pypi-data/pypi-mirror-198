"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionReplays_index_tsx"],{"./app/views/performance/transactionSummary/transactionReplays/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>C});var n=s("./app/components/acl/feature.tsx"),a=s("./app/components/alert.tsx"),r=s("./app/components/layouts/thirds.tsx"),i=s("./app/locale.tsx"),o=s("./app/utils/useOrganization.tsx"),p=s("../node_modules/react/index.js"),l=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),c=s("./app/components/loadingIndicator.tsx"),u=s("./app/utils/discover/eventView.tsx"),d=s("./app/utils/discover/fields.tsx"),y=s("./app/utils/replays/hooks/useReplayList.tsx"),m=s("./app/utils/useLocation.tsx"),v=s("./app/utils/useMedia.tsx"),g=s("./app/utils/useProjects.tsx"),f=s("./app/views/performance/transactionSummary/pageLayout.tsx"),h=s("./app/views/performance/transactionSummary/tabs.tsx"),x=s("./app/views/replays/replayTable/index.tsx"),w=s("./app/views/replays/replayTable/types.tsx"),Z=s("../node_modules/@sentry/core/esm/exports.js"),b=s("./app/utils/discover/genericDiscoverQuery.tsx"),E=s("./app/utils/queryString.tsx"),R=s("./app/utils/replays/fetchReplayList.tsx"),j=s("./app/utils/useApi.tsx"),k=s("./app/views/replays/types.tsx");var I=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function S(){const e=(0,m.T)(),t=(0,o.Z)(),{projects:s}=(0,g.Z)();return(0,I.tZ)(f.ZP,{location:{...e,query:{...e.query,statsPeriod:"14d"}},organization:t,projects:s,tab:h.Z.Replays,getDocumentTitle:q,generateEventView:z,childComponent:L})}function q(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,i.t)("Replays")].join(" — "):[(0,i.t)("Summary"),(0,i.t)("Replays")].join(" — ")}function z(e){let{location:t,transactionName:s}=e;const n=["replayId","count()","transaction.duration","trace","timestamp",...d.$4,d.zD];return u.ZP.fromSavedQuery({id:"",name:"Replay events within a transaction",version:2,fields:n,query:`event.type:transaction transaction:"${s}" !replayId:""`,projects:[Number(t.query.project)]})}function L(e){let{eventView:t,location:s,organization:n,setError:a}=e;const{data:i,fetchError:o,isFetching:l,pageLinks:d}=function(e){let{location:t,organization:s,replayIdsEventView:n}=e;const a=(0,j.Z)(),[r,i]=(0,p.useState)({events:[],pageLinks:null,replayIds:void 0}),[o,l]=(0,p.useState)(),{cursor:c}=t.query,d=(0,p.useCallback)((async()=>{try{const[{data:e},t,r]=await(0,b.AA)(a,`/organizations/${s.slug}/events/`,n.getEventsAPIPayload({query:{cursor:c}}));i({pageLinks:r?.getResponseHeader("Link")??"",replayIds:e.map((e=>String(e.replayId))),events:e||[]})}catch(e){Z.Tb(e),l(e)}}),[a,c,s.slug,n]),y=(0,p.useMemo)((()=>r.replayIds?u.ZP.fromSavedQuery({id:"",name:"",version:2,fields:k.p,projects:[],query:`id:[${String(r.replayIds)}]`,orderby:(0,E.ro)(t.query.sort,R.y)}):null),[t.query.sort,r.replayIds]);return(0,p.useEffect)((()=>{d()}),[d]),{data:y?{events:r.events,replayRecordsEventView:y}:null,fetchError:o,isFetching:!o&&!r.replayIds,pageLinks:r.pageLinks}}({replayIdsEventView:t,location:s,organization:n});if((0,p.useEffect)((()=>{a(o?.message??o)}),[a,o]),!i)return l?(0,I.tZ)(r.or,{fullWidth:!0,children:(0,I.tZ)(c.Z,{})}):(0,I.tZ)(p.Fragment,{children:null});const{events:y,replayRecordsEventView:m}=i;return(0,I.tZ)(T,{eventView:m,events:y,organization:n,pageLinks:d})}function T(e){let{eventView:t,events:s,organization:n}=e;const a=(0,p.useMemo)((()=>({query:{}})),[]),i=(0,l.u)(),o=(0,v.Z)(`(min-width: ${i.breakpoints.small})`),{replays:c,isFetching:u,fetchError:d}=(0,y.Z)({eventView:t,location:a,organization:n}),m=function(e){let{events:t,replays:s}=e;const n=s?.map((e=>{const s=t.reduce(((t,s)=>s.replayId!==e.id?t:t["transaction.duration"]?s["transaction.duration"]>t["transaction.duration"]?s:t:s),{});return{...e,txEvent:s??{}}}));return n}({replays:c,events:s});return(0,I.tZ)(r.or,{fullWidth:!0,children:(0,I.tZ)(x.Z,{fetchError:d,isFetching:u,replays:m,sort:void 0,visibleColumns:[w.M.replay,...o?[w.M.slowestTransaction]:[],w.M.os,w.M.browser,w.M.duration,w.M.countErrors,w.M.activity]})})}S.displayName="TransactionReplays",L.displayName="ReplaysContentWrapper",T.displayName="ReplaysContent";const M=S;function V(){return(0,I.tZ)(r.T3,{withPadding:!0,children:(0,I.tZ)(a.bZ,{type:"warning",children:(0,i.t)("You don't have access to this feature")})})}function _(){const e=(0,o.Z)();return(0,I.tZ)(n.Z,{features:["session-replay"],organization:e,renderDisabled:V,children:(0,I.tZ)(M,{})})}V.displayName="renderNoAccess",_.displayName="TransactionReplaysContainer";const C=_}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionReplays_index_tsx.21a6c404de3e6c7bf94f5d490e721e1b.js.map