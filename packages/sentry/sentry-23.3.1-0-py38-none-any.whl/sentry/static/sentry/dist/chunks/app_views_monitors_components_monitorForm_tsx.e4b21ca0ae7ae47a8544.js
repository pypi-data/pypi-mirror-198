"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_monitors_components_monitorForm_tsx"],{"./app/utils/slugify.tsx":(e,t,n)=>{function i(e){return e.normalize("NFKD").toLowerCase().replace(" ","-").replace(/[^a-z0-9-_]/g,"")}n.d(t,{Z:()=>i})},"./app/views/monitors/components/monitorForm.tsx":(e,t,n)=>{n.d(t,{Z:()=>T});var i=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=n("../node_modules/react/index.js"),r=n("../node_modules/mobx-react-lite/es/index.js"),l=n("./app/components/alert.tsx"),a=n("./app/components/forms/fields/numberField.tsx"),c=n("./app/components/forms/fields/radioField.tsx"),d=n("./app/components/forms/fields/selectField.tsx"),u=n("./app/components/forms/fields/sentryProjectSelectorField.tsx"),p=n("./app/components/forms/fields/textField.tsx"),m=n("./app/components/forms/form.tsx"),h=n("./app/components/forms/model.tsx"),f=n("./app/components/links/externalLink.tsx"),g=n("./app/components/list/index.tsx"),Z=n("./app/components/list/listItem.tsx"),x=n("./app/components/text.tsx"),y=n("./app/components/timeSince.tsx"),b=n("./app/data/timezones.tsx"),k=n("./app/locale.tsx"),w=n("./app/styles/space.tsx"),v=n("./app/utils/slugify.tsx"),_=n("./app/utils/theme.tsx"),j=n("./app/utils/usePageFilters.tsx"),C=n("./app/utils/useProjects.tsx"),I=n("./app/views/monitors/utils.tsx"),S=n("./app/views/monitors/types.tsx"),N=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const R=[[S.Ix.CRONTAB,(0,k.t)("Crontab")],[S.Ix.INTERVAL,(0,k.t)("Interval")]],q="cron_job";function A(e,t){return t.fields.toJSON().reduce(((e,t)=>{let[n,i]=t;return n.startsWith("config.")?(e.config??={},"config.schedule.frequency"!==n&&"config.schedule.interval"!==n||Array.isArray(e.config.schedule)||(e.config.schedule=[1,"hour"]),Array.isArray(e.config.schedule)&&"config.schedule.frequency"===n?(e.config.schedule[0]=parseInt(i,10),e):Array.isArray(e.config.schedule)&&"config.schedule.interval"===n?(e.config.schedule[1]=i,e):(e.config[n.substr(7)]=i,e)):(e[n]=i,e)}),{})}function E(e){let{monitor:t,submitLabel:n,apiEndpoint:o,apiMethod:a,onSubmitSuccess:d}=e;const u=(0,s.useRef)(new h.Z({transformData:A})),{projects:p}=(0,C.Z)(),{selection:g}=(0,j.Z)(),[Z,x]=(0,s.useState)(t?.config.schedule_type===S.Ix.CRONTAB?t?.config.schedule:null),w=g.projects[0],E=w?p.find((e=>e.id===w+"")):null,T=(0,I.Z)(Z);return(0,N.tZ)(m.Z,{allowUndo:!0,requireChanges:!0,apiEndpoint:o,apiMethod:a,model:u.current,initialData:t?{name:t.name,slug:t.slug,type:t.type??q,project:t.project.slug,...function(e,t){const n={};return"cron_job"===e&&(n["config.schedule_type"]=t.schedule_type,n["config.checkin_margin"]=t.checkin_margin,n["config.max_runtime"]=t.max_runtime,"interval"===t.schedule_type?(n["config.schedule.frequency"]=t.schedule[0],n["config.schedule.interval"]=t.schedule[1]):(n["config.schedule"]=t.schedule,n["config.timezone"]=t.timezone)),n}(t.type,t.config)}:{project:E?E.slug:null,type:q},onSubmitSuccess:d,submitLabel:n,children:(0,N.BX)(O,{symbol:"colored-numeric",children:[(0,N.tZ)(L,{children:(0,k.t)("Add a name and project")}),(0,N.tZ)(P,{children:(0,k.t)("The monitor name will show up in alerts and notifications")}),(0,N.BX)(V,{children:[(0,N.tZ)(z,{name:"name",placeholder:(0,k.t)("My Cron Job"),required:!0,stacked:!0,inline:!1}),t&&(0,N.tZ)(z,{name:"slug",help:(0,k._N)("The [strong:monitor-slug] is used to uniquely identify your monitor within your organization. Changing this slug will require updates to any instrumented check-in calls.",{strong:(0,N.tZ)("strong",{})}),placeholder:(0,k.t)("monitor-slug"),required:!0,stacked:!0,inline:!1,transformInput:v.Z}),(0,N.tZ)(M,{name:"project",projects:p.filter((e=>e.isMember)),placeholder:(0,k.t)("Choose Project"),disabled:!!t,disabledReason:(0,k.t)("Existing monitors cannot be moved between projects"),valueIsSlug:!0,required:!0,stacked:!0,inline:!1})]}),(0,N.tZ)(L,{children:(0,k.t)("Choose your schedule type")}),(0,N.tZ)(P,{children:(0,k._N)("You can use [link:the crontab syntax] or our interval schedule.",{link:(0,N.tZ)(f.Z,{href:"https://en.wikipedia.org/wiki/Cron"})})}),(0,N.tZ)(V,{children:(0,N.tZ)(c.Z,{name:"config.schedule_type",choices:R,defaultValue:S.Ix.CRONTAB,orientInline:!0,required:!0,stacked:!0,inline:!1})}),(0,N.tZ)(L,{children:(0,k.t)("Choose your schedule")}),(0,N.tZ)(P,{children:(0,k.t)("How often you expect your recurring jobs to run.")}),(0,N.BX)(V,{children:[void 0!==t&&t.nextCheckIn&&(0,N.tZ)(l.ZP,{type:"info",children:(0,k._N)("Any changes you make to the execution schedule will only be applied after the next expected check-in [nextCheckin].",{nextCheckin:(0,N.tZ)("strong",{children:(0,N.tZ)(y.Z,{date:t.nextCheckIn})})})}),(0,N.tZ)(r.Qj,{children:()=>{const e=u.current.getValue("config.schedule_type");return"crontab"===e?(0,N.BX)(X,{children:[(0,N.tZ)(z,{name:"config.schedule",placeholder:"*/5 * * * *",css:(0,i.iv)({input:{fontFamily:_.ZP.text.familyMono}},"",""),required:!0,stacked:!0,onChange:x,inline:!1}),(0,N.tZ)(F,{name:"config.timezone",defaultValue:"UTC",options:b.f,required:!0,stacked:!0,inline:!1}),T&&(0,N.BX)(K,{children:['"',T,'"']})]}):"interval"===e?(0,N.BX)(X,{interval:!0,children:[(0,N.tZ)(D,{children:(0,k.t)("Every")}),(0,N.tZ)(B,{name:"config.schedule.frequency",placeholder:"e.g. 1",required:!0,stacked:!0,inline:!1}),(0,N.tZ)(F,{name:"config.schedule.interval",options:(t=Number(u.current.getValue("config.schedule.frequency")??1),[{value:"minute",label:(0,k.tn)("minute","minutes",t)},{value:"hour",label:(0,k.tn)("hour","hours",t)},{value:"day",label:(0,k.tn)("day","days",t)},{value:"week",label:(0,k.tn)("week","weeks",t)},{value:"month",label:(0,k.tn)("month","months",t)},{value:"year",label:(0,k.tn)("year","years",t)}]),placeholder:"minute",required:!0,stacked:!0,inline:!1})]}):null;var t}})]}),(0,N.tZ)(L,{children:(0,k.t)("Set a missed status")}),(0,N.tZ)(P,{children:(0,k.t)("The number of minutes we'll wait before we consider a check-in as missed.")}),(0,N.tZ)(V,{children:(0,N.tZ)(B,{name:"config.checkin_margin",placeholder:"e.g. 30",stacked:!0,inline:!1})}),(0,N.tZ)(L,{children:(0,k.t)("Set a failed status")}),(0,N.tZ)(P,{children:(0,k.t)("The number of minutes a check-in is allowed to run before it's considered failed.")}),(0,N.tZ)(V,{children:(0,N.tZ)(B,{name:"config.max_runtime",placeholder:"e.g. 30",stacked:!0,inline:!1})})]})})}E.displayName="MonitorForm";const T=E,O=(0,o.Z)(g.Z,{target:"epnopid10"})({name:"yrf9ut",styles:"width:600px"}),B=(0,o.Z)(a.Z,{target:"epnopid9"})({name:"1hcx8jb",styles:"padding:0"}),F=(0,o.Z)(d.Z,{target:"epnopid8"})({name:"1hcx8jb",styles:"padding:0"}),z=(0,o.Z)(p.Z,{target:"epnopid7"})({name:"1hcx8jb",styles:"padding:0"}),M=(0,o.Z)(u.Z,{target:"epnopid6"})({name:"1hcx8jb",styles:"padding:0"}),L=(0,o.Z)(Z.Z,{target:"epnopid5"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";font-weight:bold;line-height:1.3;"),D=(0,o.Z)(x.Z,{target:"epnopid4"})("font-weight:bold;color:",(e=>e.theme.subText),";"),P=(0,o.Z)(D,{target:"epnopid3"})("font-weight:normal;padding-left:",(0,w.Z)(4),";"),V=(0,o.Z)("div",{target:"epnopid2"})("padding-left:",(0,w.Z)(4),";margin-top:",(0,w.Z)(1),";margin-bottom:",(0,w.Z)(4),";display:flex;flex-direction:column;gap:",(0,w.Z)(1),";"),X=(0,o.Z)("div",{target:"epnopid1"})("display:grid;align-items:center;gap:",(0,w.Z)(1),";grid-template-columns:",(e=>e.interval&&"auto")," 1fr 2fr;"),K=(0,o.Z)(D,{target:"epnopid0"})("font-weight:normal;font-size:",(e=>e.theme.fontSizeExtraSmall),";font-family:",(e=>e.theme.text.familyMono),";grid-column:auto/span 2;")},"./app/views/monitors/types.tsx":(e,t,n)=>{let i,o,s,r;n.d(t,{Ix:()=>o,NI:()=>r,wo:()=>s}),function(e){e.UNKNOWN="unknown",e.CRON_JOB="cron_job"}(i||(i={})),function(e){e.CRONTAB="crontab",e.INTERVAL="interval"}(o||(o={})),function(e){e.OK="ok",e.ERROR="error",e.DISABLED="disabled",e.ACTIVE="active",e.MISSED_CHECKIN="missed_checkin"}(s||(s={})),function(e){e.OK="ok",e.ERROR="error",e.IN_PROGRESS="in_progress",e.MISSED="missed"}(r||(r={}))},"./app/views/monitors/utils.tsx":(e,t,n)=>{n.d(t,{Z:()=>r});var i=n("../node_modules/cronstrue/dist/cronstrue.js"),o=n.n(i),s=n("./app/utils/dates.tsx");function r(e){if(!e)return null;let t;try{t=o().toString(e,{verbose:!0,use24HourTimeFormat:(0,s.gn)()})}catch(e){return null}return t}}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_components_monitorForm_tsx.4af6934d23f2da085c34e0ef3ba45470.js.map